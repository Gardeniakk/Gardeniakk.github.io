<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="CG-CTF Writeup"><meta name="keywords" content="CTF,Writeup,Web,Crypto,Misc"><meta name="author" content="Gard3nia"><meta name="copyright" content="Gard3nia"><title>CG-CTF Writeup | Gard3nia's Blog</title><link rel="shortcut icon" href="/rea.jpg"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正文"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web题解"><span class="toc-number">2.1.</span> <span class="toc-text">Web题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文件包含"><span class="toc-number">2.1.1.</span> <span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bypass-again"><span class="toc-number">2.1.2.</span> <span class="toc-text">bypass again</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x00"><span class="toc-number">2.1.3.</span> <span class="toc-text">/x00</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL1"><span class="toc-number">2.1.4.</span> <span class="toc-text">SQL1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MYSQL"><span class="toc-number">2.1.5.</span> <span class="toc-text">MYSQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passcheck"><span class="toc-number">2.1.6.</span> <span class="toc-text">passcheck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量覆盖"><span class="toc-number">2.1.7.</span> <span class="toc-text">变量覆盖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#起名字真难"><span class="toc-number">2.1.8.</span> <span class="toc-text">起名字真难</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#密码重置"><span class="toc-number">2.1.9.</span> <span class="toc-text">密码重置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC题解"><span class="toc-number">2.2.</span> <span class="toc-text">MISC题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#丘比龙De女神"><span class="toc-number">2.2.1.</span> <span class="toc-text">丘比龙De女神</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remove-Boyfriend"><span class="toc-number">2.2.2.</span> <span class="toc-text">Remove Boyfriend</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5"><span class="toc-number">2.2.3.</span> <span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图种"><span class="toc-number">2.2.4.</span> <span class="toc-text">图种</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto题解"><span class="toc-number">2.3.</span> <span class="toc-text">Crypto题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easy"><span class="toc-number">2.3.1.</span> <span class="toc-text">easy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#keyboard"><span class="toc-number">2.3.2.</span> <span class="toc-text">keyboard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BabyRSA"><span class="toc-number">2.3.3.</span> <span class="toc-text">BabyRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异性相吸"><span class="toc-number">2.3.4.</span> <span class="toc-text">异性相吸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wiener-Wiener-Chicken-Dinner"><span class="toc-number">2.3.5.</span> <span class="toc-text">Wiener Wiener Chicken Dinner</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gard3nia</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">27</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">12</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">4</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">friendlinks</div><a class="author-info-links__name text-center" href="https://skysec.top">一叶飘零学长</a><a class="author-info-links__name text-center" href="https://0verwatch.top/">0verwatch</a><a class="author-info-links__name text-center" href="https://comydream.github.io">Source</a><a class="author-info-links__name text-center" href="http://chaosec.top/">Charles</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://s1.ax1x.com/2018/12/27/FRVGCQ.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gard3nia's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">时间轴</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">归档</a><a class="site-page" href="/about">简介</a></span></div><div id="post-info"><div id="post-title">CG-CTF Writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Writeup/">Writeup</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">3.9k</span><span class="post-meta__separator">|</span><span>Reading time: 15 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>萌新刷题，寒假又补充更新了Crypto部分；<a id="more"></a></p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="Web题解"><a href="#Web题解" class="headerlink" title="Web题解"></a>Web题解</h2><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><p><strong>1.直接包含内有运行代码的文件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  include <span class="variable">$_GET</span>[<span class="string">'file'</span>];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>那么就可以通过抓包修改file值的办法去运行一些本来不该运行的文件也可以通过此方法直接输出一些敏感的配置文件和远程包含shell（需要目标主机开启allow_url_fopen)<br><strong>2.通过PHP内置协议直接读取代码</strong><br>通过构造以下语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.com/index.php?file=php://filter/read=convert.base64-encode/resource=xxx.php</span><br></pre></td></tr></table></figure></p>
<p>就能获得xxx.php的代码的base64加密结果，通过base64解密后便可获得xxx.php的代码<br><strong>3.写入php文件</strong><br>使用如下URL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.com/index.php?file=php://input</span><br></pre></td></tr></table></figure></p>
<p>并在http头里提交<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&quot;&lt;?php eval($_post[&apos;xxx&apos;];?&gt;&quot;)?&gt;</span><br></pre></td></tr></table></figure></p>
<p>就能在index.php目录下生成shell.php</p>
<p>此题考查顾名思义为文件包含漏洞，点开click me? no;<br><img src="https://s1.ax1x.com/2018/11/09/ibA5fe.png" alt="打开界面"><br><img src="https://s1.ax1x.com/2018/11/09/ibAqmt.png" alt="点开以后的URL"><br>通过URL里<strong>?file=show.php</strong>大致可以确定为是GET方式提交<br>构造以下语句：<br><img src="https://s1.ax1x.com/2018/11/09/ibEn1J.png" alt="构造的URL"><br>得到一大串的base64编码，进行base64解码得到php代码里就有flag<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;asdf&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="variable">$_GET</span>[file])&#123;<span class="built_in">echo</span> <span class="string">'&lt;a href="./index.php?file=show.php"&gt;click me? no&lt;/a&gt;'</span>;&#125;</span><br><span class="line">	<span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">'file'</span>];</span><br><span class="line">	<span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">"../"</span>)||stristr(<span class="variable">$file</span>, <span class="string">"tp"</span>)||stristr(<span class="variable">$file</span>,<span class="string">"input"</span>)||stristr(<span class="variable">$file</span>,<span class="string">"data"</span>))&#123;</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">		<span class="built_in">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	include(<span class="variable">$file</span>); </span><br><span class="line">//flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="bypass-again"><a href="#bypass-again" class="headerlink" title="bypass again"></a>bypass again</h3><p>这一题是一个PHP弱类型绕过的题目<br><img src="https://s1.ax1x.com/2018/11/13/iOHTeJ.png" alt=""><br>具体的PHP弱类型分析参考的是这一篇文章：<a href="http://www.cnblogs.com/Mrsm1th/p/6745532.html" target="_blank" rel="noopener">http://www.cnblogs.com/Mrsm1th/p/6745532.html</a><br>php中有两种比较的符号 == 与 ===<br>=== 在进行比较的时候，会先判断两种字符串的类型是否相等，再比较<br>== 在进行比较的时候，会先将字符串类型转化成相同，再比较<br>题目如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isset(<span class="variable">$_GET</span>[<span class="string">'a'</span>]) and isset(<span class="variable">$_GET</span>[<span class="string">'b'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">'a'</span>] != <span class="variable">$_GET</span>[<span class="string">'b'</span>])</span><br><span class="line">    <span class="keyword">if</span> (md5(<span class="variable">$_GET</span>[<span class="string">'a'</span>]) == md5(<span class="variable">$_GET</span>[<span class="string">'b'</span>]))</span><br><span class="line">    die(<span class="string">'Flag: '</span>.<span class="variable">$flag</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">'Wrong.'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>所以当判断中为”==”的时候会将两边先转换为一样的数据类型;0e在比较的时候会将其视作为科学计数法，所以无论0e后面是什么，0的多少次方还是0，md5(‘240610708’) == md5(‘QNKCDZO’)成功绕过!<br>因为是GET方式提交的数据，所以可以直接修改url的值来提交a和b的值，提交两个结果MD5加密以后前两位都是0e的值，这样php就会认为这两个值经过MD5加密以后的值都为0，所以就可以直接爆出flag<br><img src="https://s1.ax1x.com/2018/11/13/iX3CHf.png" alt=""></p>
<h3 id="x00"><a href="#x00" class="headerlink" title="/x00"></a>/x00</h3><p>题目如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isset (<span class="variable">$_GET</span>[<span class="string">'nctf'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, <span class="variable">$_GET</span>[<span class="string">'nctf'</span>]) === FALSE)</span><br><span class="line">            <span class="built_in">echo</span> <span class="string">'必须输入数字才行'</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos (<span class="variable">$_GET</span>[<span class="string">'nctf'</span>], <span class="string">'#biubiubiu'</span>) !== FALSE)   </span><br><span class="line">            die(<span class="string">'Flag: '</span>.<span class="variable">$flag</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">'骚年，继续努力吧啊~'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这题考察的是ereg()的00截断，满足nctf必须是1-9的实数；<br>strpos函数判断的是后面的字符中在前面的字符中出现的位置，返回其位置，从0开始；<br>所以试一下1%00#biubiubiu,先截断输入的数字，使ereg()函数不能识别到%00后面字符，所以就顺利绕过ereg()函数的判断，<br>其次要使得strpos函数识别到nctf中包含了#biubiubiu这一串字符，<br>但是在url中不能识别#，所以就使用url编码%23来替换#，所以构造如下的url<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php?nctf=1%00%23biubiubiu</span><br></pre></td></tr></table></figure></p>
<p>就可以直接弹出flag<br><img src="https://s1.ax1x.com/2018/11/14/iXLhvV.png" alt=""></p>
<h3 id="SQL1"><a href="#SQL1" class="headerlink" title="SQL1"></a>SQL1</h3><p>SQL注入题，源码如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">Secure Web Login</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[user] &amp;&amp; <span class="variable">$_POST</span>[pass]) &#123;</span><br><span class="line">    mysql_connect(SAE_MYSQL_HOST_M . <span class="string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span><br><span class="line">  mysql_select_db(SAE_MYSQL_DB);</span><br><span class="line">  <span class="variable">$user</span> = trim(<span class="variable">$_POST</span>[user]);</span><br><span class="line">  <span class="variable">$pass</span> = md5(trim(<span class="variable">$_POST</span>[pass]));</span><br><span class="line">  <span class="variable">$sql</span>=<span class="string">"select user from ctf where (user='"</span>.<span class="variable">$user</span>.<span class="string">"') and (pw='"</span>.<span class="variable">$pass</span>.<span class="string">"')"</span>; admin</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>.<span class="variable">$sql</span>;</span><br><span class="line">  <span class="variable">$query</span> = mysql_fetch_array(mysql_query(<span class="variable">$sql</span>));</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$query</span>[user]==<span class="string">"admin"</span>) &#123;</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$query</span>[user] != <span class="string">"admin"</span>) &#123;</span><br><span class="line">    <span class="built_in">echo</span>(<span class="string">"&lt;p&gt;You are not admin!&lt;/p&gt;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$query</span>[user];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;form method=post action=index.php&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=text name=user value=<span class="string">"Username"</span>&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=password name=pass value=<span class="string">"Password"</span>&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=submit&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;a href=<span class="string">"index.phps"</span>&gt;Source&lt;/a&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>和老师上课讲的例子很吻合，就是一个很基础的用引号强行将原来的引号闭合，然后添加上括号，用#对后面的内容进行注释就可以了<br>题目要求用admin登录才可以获取flag，所以注入的内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos;)#</span><br></pre></td></tr></table></figure></p>
<p>闭合掉单引号然后闭合括号，注释掉后面对pass的判断，直接弹出flag<br><img src="https://s1.ax1x.com/2018/11/15/iv41B9.png" alt=""></p>
<h3 id="MYSQL"><a href="#MYSQL" class="headerlink" title="MYSQL"></a>MYSQL</h3><p>这题是在页面给了提示robots.txt<br><img src="https://s1.ax1x.com/2018/11/15/ivIMw9.png" alt=""><br>查看此文件的内容得到如下的内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TIP:sql.php</span></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id]) &#123;</span><br><span class="line">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span><br><span class="line">  mysql_select_db(SAE_MYSQL_DB);</span><br><span class="line">  <span class="variable">$id</span> = intval(<span class="variable">$_GET</span>[id]);</span><br><span class="line">  <span class="variable">$query</span> = @mysql_fetch_array(mysql_query(<span class="string">"select content from ctf2 where id='<span class="variable">$id</span>'"</span>));</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$_GET</span>[id]==1024) &#123;</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"&lt;p&gt;no! try again&lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">echo</span>(<span class="variable">$query</span>[content]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>tip为sql.php,然后还要用GET传一个id上去，这个id经过intval()函数以后赋值$id,要求传的id不等于1024<br>但是要得到id=1024的值，所以试一下1024.1成功得到flag<br>但是自己依旧是一脸懵逼…不知道咋的就蹦出来flag；<br><img src="https://s1.ax1x.com/2018/11/15/ivoKc8.png" alt=""><br>事后查了一下intval函数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="built_in">echo</span>(intval(1024.1));</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span>(intval(1024.4));</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span>(intval(1024.5));</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span>(intval(1024.9));</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>这是测试的结果<br><img src="https://s1.ax1x.com/2018/11/15/ivoMjS.png" alt=""><br>测试了一下这个函数的用处:intval最常用的是在程序中功滤入进数据库的变量，将其转换为整型<br>所以只要传一个整型值为1024而且自生不是1024的数值进去就可以了……soga……</p>
<h3 id="passcheck"><a href="#passcheck" class="headerlink" title="passcheck"></a>passcheck</h3><p>题目给出了源码,代码审计题<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pass</span>=@<span class="variable">$_POST</span>[<span class="string">'pass'</span>];</span><br><span class="line"><span class="variable">$pass1</span>=***********;//被隐藏起来的密码</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(@!strcmp(<span class="variable">$pass</span>,<span class="variable">$pass1</span>))&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"flag:nctf&#123;*&#125;"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"the pass is wrong!"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"please input pass!"</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>也就是strcmp($pass,$pass1)值为0的时候输出flag，所以应该又是绕过之类的题目，小白不知道这个函数的作用个，所以上网科普了一下，PHP中strcmp函数的作用如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="built_in">echo</span> strcmp(<span class="string">"Hello world!"</span>,<span class="string">"Hello world!"</span>); // 两字符串相等</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> strcmp(<span class="string">"Hello world!"</span>,<span class="string">"Hello"</span>); // string1 大于 string2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> strcmp(<span class="string">"Hello world!"</span>,<span class="string">"Hello world! Hello!"</span>); // string1 小于 string2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">0</span><br><span class="line">7</span><br><span class="line">-7</span><br></pre></td></tr></table></figure></p>
<p>以上代码用于测试此函数的作用结果显而易见，len(string1)==len(string2)返回0，否则返回string1比string2长多少或者短多少。<br>此题要求<strong>strcmp($pass,$pass1)</strong>的值为0，你不可能知道pass1的长度，所以要想办法绕过这个条件满足条件，上网搜索了一下，发现只要post一个数组过去就可以了，写一个py脚本传参到指定的url<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=<span class="string">"http://chinalover.sinaapp.com/web21/"</span></span><br><span class="line">s=requests.Session()</span><br><span class="line">post=&#123;<span class="string">"pass[]"</span>:1&#125;</span><br><span class="line"><span class="built_in">print</span>(s.post(url,data=post).text)</span><br></pre></td></tr></table></figure></p>
<p>得到flag如下：<br><img src="https://s1.ax1x.com/2018/11/17/izcFJS.png" alt=""></p>
<h3 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h3><p>今天又学到了一点新知识，关于php里的变量覆盖问题<br>题目如下：<br><img src="https://s1.ax1x.com/2018/11/28/FVcFUO.png" alt=""><br>在底部给出了sourcecode，查看一波源码<br><img src="https://s1.ax1x.com/2018/11/28/FVcKqP.png" alt=""><br>发现存在extract()函数，应该就是这个函数的问题，extract函数的用处如下<br><img src="https://s1.ax1x.com/2018/11/28/FVcwZV.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">extract() 函数从数组中将变量导入到当前的符号表。</span><br><span class="line">该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</span><br><span class="line">该函数返回成功设置的变量数目。</span><br></pre></td></tr></table></figure></p>
<p>会将对应的键值当做变量，并且将键对应的值赋值给这个变量，所以就存在原先已经赋过值的变量被重新赋值的现象。<br>这题的要求就是:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pass==$thepassword_123</span><br></pre></td></tr></table></figure></p>
<p>题目要求是post，就直接传两个相等的值即可<br><img src="https://s1.ax1x.com/2018/11/28/FVgQyR.png" alt=""><br>结果如下：<br><img src="https://s1.ax1x.com/2018/11/28/FVgw6A.png" alt=""></p>
<h3 id="起名字真难"><a href="#起名字真难" class="headerlink" title="起名字真难"></a>起名字真难</h3><p>源码如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">function</span> noother_says_correct(<span class="variable">$number</span>)</span><br><span class="line">&#123;</span><br><span class="line">       <span class="variable">$one</span> = ord(<span class="string">'1'</span>);</span><br><span class="line">       <span class="variable">$nine</span> = ord(<span class="string">'9'</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; strlen(<span class="variable">$number</span>); <span class="variable">$i</span>++)</span><br><span class="line">       &#123;   </span><br><span class="line">               <span class="variable">$digit</span> = ord(<span class="variable">$number</span>&#123;<span class="variable">$i</span>&#125;);</span><br><span class="line">               <span class="keyword">if</span> ( (<span class="variable">$digit</span> &gt;= <span class="variable">$one</span>) &amp;&amp; (<span class="variable">$digit</span> &lt;= <span class="variable">$nine</span>) )</span><br><span class="line">               &#123;</span><br><span class="line">                       <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">               &#125;</span><br><span class="line">       &#125;</span><br><span class="line">          <span class="built_in">return</span> <span class="variable">$number</span> == <span class="string">'54975581388'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">'*******'</span>;</span><br><span class="line"><span class="keyword">if</span>(noother_says_correct(<span class="variable">$_GET</span>[<span class="string">'key'</span>]))</span><br><span class="line">   <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">   <span class="built_in">echo</span> <span class="string">'access denied'</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>大概就是扫描number这个字符串，发现数字就输出”access denied”,如果没有数字就输出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return $number == &apos;54975581388&apos;;</span><br></pre></td></tr></table></figure></p>
<p>根据以前的做题经验，大概又是php弱类型的绕过，绞尽脑汁都没有想出来应该怎么绕过这个数字，再贴一篇干货帖子：<a href="https://www.freebuf.com/articles/web/166543.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/166543.html</a><br>了解到可能是传一个十六进制数上去，解析以后和原来的数相等就可以了，但我心想怎么可能这么巧就是这个十六进制数不包含0-9的数呢，不管了，先试一试，十六进制转换以后果然不包含0-9的数字…wtf?(心中万头cn马奔腾)…<br>进制转换是ccccccccc，加上十六进制符号0xccccccccc即可<br><img src="https://s1.ax1x.com/2018/11/28/FVRNMd.png" alt=""></p>
<h3 id="密码重置"><a href="#密码重置" class="headerlink" title="密码重置"></a>密码重置</h3><p>查看网页源代码：<br><img src="https://s1.ax1x.com/2018/11/28/FVTTKO.png" alt=""><br>显示数据的提交方式都是POST方式,提交的数据有user/newpass/vcode这三项，都是要POST传参的，传递的数据如下所示：<br><img src="https://s1.ax1x.com/2018/11/28/FV7ldJ.png" alt=""><br><strong>传参构造的url需要注意，将ctfuser的base64编码值换成admin的编码值</strong>结果如下：<br><img src="https://s1.ax1x.com/2018/11/28/FV7Yz6.png" alt=""></p>
<h2 id="MISC题解"><a href="#MISC题解" class="headerlink" title="MISC题解"></a><strong>MISC题解</strong></h2><h3 id="丘比龙De女神"><a href="#丘比龙De女神" class="headerlink" title="丘比龙De女神"></a>丘比龙De女神</h3><p>这题拿到手是一个文件gif,改成gif后缀发现是一张gif图片，放到kali里跑一下发现确实有点猫腻，如下图：<br><img src="https://s1.ax1x.com/2018/11/11/iqxPjf.png" alt=""><br>发现了一个zip文件，于是返回将文件格式改为zip，得到一个压缩包，解压无果，果然没这么简单，丢进十六进制编辑器得到一个gif格式的文件头，搜索003B(gif文件尾)如下<br><img src="https://s1.ax1x.com/2018/11/11/iqxNCR.png" alt=""><br>发现后面还是有文件，另存，但是感觉这个love有点奇怪，算了，先记录一下，管他有没有用。。。<br><img src="https://s1.ax1x.com/2018/11/11/iqx0KK.png" alt=""><br>文件的14 00 01 00 08 00特别熟悉，就是zip文件的文件头的一部分，说做就做，把前面改成压缩包的文件头<br><img src="https://s1.ax1x.com/2018/11/11/iqxL2q.png" alt=""><br>解压发现需要密码，填入先前记录的love解压成功，得到一张女神图片(有点…瓜)<br><img src="https://s1.ax1x.com/2018/11/11/iqzpa4.png" alt=""><br>需要的是图片的MD5值，去kali用md5sum跑一下得到flag值<br><img src="https://s1.ax1x.com/2018/11/11/iqzoy6.png" alt=""></p>
<h3 id="Remove-Boyfriend"><a href="#Remove-Boyfriend" class="headerlink" title="Remove Boyfriend"></a>Remove Boyfriend</h3><p>流量包分析题，丢进wireshark，协议分级统计发现全部为TCP数据包<br><img src="https://s1.ax1x.com/2018/11/11/iLSCm8.png" alt=""><br>追踪TCP流，在2号流里发现有用信息<br><img src="https://s1.ax1x.com/2018/11/11/iLSEfs.png" alt=""><br>在3号流里发现flag.py源码研究发现是一个凯撒加密移位算法运行发现flag is not here，证明字符串s错误，需要找到正确的s<br><img src="https://s1.ax1x.com/2018/11/11/iLSd0O.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">def Upper(ch):  </span><br><span class="line">    <span class="keyword">if</span> ch&gt;=<span class="string">'A'</span> and ch&lt;=<span class="string">'Z'</span>:  </span><br><span class="line">        <span class="built_in">return</span> True  </span><br><span class="line">  </span><br><span class="line">def Lower(ch):  </span><br><span class="line">    <span class="keyword">if</span> ch&gt;=<span class="string">'a'</span> and ch&lt;=<span class="string">'z'</span>:  </span><br><span class="line">        <span class="built_in">return</span> True  </span><br><span class="line">  </span><br><span class="line">def X1con(s):  </span><br><span class="line">    flag = <span class="string">''</span>  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:  </span><br><span class="line">        <span class="keyword">if</span> Upper(i) == True:  </span><br><span class="line">            <span class="keyword">if</span> i&gt;=<span class="string">'A'</span> and i&lt;=<span class="string">'M'</span>:  </span><br><span class="line">                flag += chr(ord(i)+13)  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                flag += chr(ord(i)-13)  </span><br><span class="line">        <span class="keyword">elif</span> Lower(i) == True:  </span><br><span class="line">            <span class="keyword">if</span> i&gt;=<span class="string">'a'</span> and i&lt;=<span class="string">'m'</span>:  </span><br><span class="line">                flag += chr(ord(i)+13)  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                flag += chr(ord(i)-13)  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            flag += i  </span><br><span class="line">    <span class="built_in">return</span> flag  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:  </span><br><span class="line">    s = <span class="string">'&#123;synt_vf_abg_urer&#125;'</span>  </span><br><span class="line">    <span class="built_in">print</span> X1con(s)</span><br></pre></td></tr></table></figure></p>
<p>在6号流里发现有用信息，发现文件头为png，是图片没得跑<br><img src="https://s1.ax1x.com/2018/11/11/iLSy9A.png" alt=""><br><img src="https://s1.ax1x.com/2018/11/11/iLpZUe.png" alt=""><br>转为原始数据保存为png文件果然得到一张小姐姐的照片,在左下角发现字符串信息，提交试一下不行<br><img src="https://s1.ax1x.com/2018/11/11/iLpu8A.png" alt=""><br>将之前的py文件里的变量s改为这个字符串运行得到flag<br><img src="https://s1.ax1x.com/2018/11/11/iLpJUg.png" alt=""></p>
<h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>这题给出一段MD5加密的部分明文和密文<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：e9032???da???08????911513?0???a2 </span><br><span class="line">明文：TASC?O3RJMV?WDJKX?ZM</span><br><span class="line">要求你还原出密文并且加上nctf&#123;&#125;提交</span><br></pre></td></tr></table></figure></p>
<p>网络安全课程上老师讲了口令破解的时候讲了暴力破解，新学了个比较有用的脚本可以专门用来爆破MD5口令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">str1=<span class="string">'TASC'</span></span><br><span class="line">str2=<span class="string">'O3RJMV'</span></span><br><span class="line">str3=<span class="string">'WDJKX'</span></span><br><span class="line">str4=<span class="string">'ZM'</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(32,126):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> range(32,126):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(32,126):</span><br><span class="line">            m=str1+chr(a)+str2+chr(b)+str3+chr(c)+str4</span><br><span class="line">            x=hashlib.md5(m).hexdigest()</span><br><span class="line">            <span class="keyword">if</span>(x[0:5]==<span class="string">'e9032'</span>):</span><br><span class="line">                <span class="built_in">print</span> x</span><br></pre></td></tr></table></figure></p>
<p>在ASCII码32~126之间对这三个缺失的明文字符进行穷举，由于MD5加密的不可逆性质，所以采用对比密文的方式检验，如果前五位和原来一<br>样就相当于找到了正确的明文，暴力破解得到密文串，加上nctf提交即可</p>
<h3 id="图种"><a href="#图种" class="headerlink" title="图种"></a>图种</h3><p>这题是一个简单的隐写题，给了一个gif格式的图片，话不多说直接丢进十六进制编辑器，搜索关键字504B0304得到一个PK文件头<br><img src="https://s1.ax1x.com/2018/11/13/iOTo1U.png" alt=""><br>将文件改为zip格式后解压即可再次得到一个gif图片，flag是图片最后一句话的首字母加上nctf提交即可<br><img src="https://s1.ax1x.com/2018/11/13/iOTL7R.png" alt=""></p>
<h2 id="Crypto题解"><a href="#Crypto题解" class="headerlink" title="Crypto题解"></a>Crypto题解</h2><h3 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h3><p>直接base64解码即可；</p>
<h3 id="keyboard"><a href="#keyboard" class="headerlink" title="keyboard"></a>keyboard</h3><p>直接看键盘即可</p>
<h3 id="BabyRSA"><a href="#BabyRSA" class="headerlink" title="BabyRSA"></a>BabyRSA</h3><p>这题也是十分基础，就是给出<code>(e,n)</code>还有<code>cipher</code>的十六进制，全部转化为10进制以后，素因数分解n（此处使用分解工具即可）：</p>
<p><img src="https://s2.ax1x.com/2019/01/20/kPPPQU.png" alt="kPPPQU.png"></p>
<p>找到<code>p,q</code>即可求出φ(n);</p>
<p><strong>攻击脚本：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#(e,n)=(0x10001,0x291733BAB061EF9C599139CB3E40A5C762B6F448FFFFFFFFFFFFFF)</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">e=<span class="string">"0x10001"</span></span><br><span class="line">n=<span class="string">"0x291733BAB061EF9C599139CB3E40A5C762B6F448FFFFFFFFFFFFFF"</span></span><br><span class="line">m=<span class="string">"0x237200C0F72B97DB55BA37C7AACBB61A26A0CB47D294726259C4DF"</span></span><br><span class="line">ee=int(e,<span class="number">16</span>)</span><br><span class="line">nn=int(n,<span class="number">16</span>)</span><br><span class="line">mm=int(m,<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> ee,nn</span><br><span class="line">p=<span class="number">1578173871764844869716052171</span></span><br><span class="line">q=<span class="number">10710927547195113973175047066215146269</span></span><br><span class="line">ol=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">dd=gmpy2.invert(ee,ol)</span><br><span class="line">plain=pow(mm,dd,nn)</span><br><span class="line">ans=<span class="string">'&#123;:x&#125;'</span>.format(plain).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> ans</span><br></pre></td></tr></table></figure>
<p>得出flag：</p>
<p><a href="https://imgchr.com/i/kPPFL4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/20/kPPFL4.md.png" alt="kPPFL4.md.png"></a></p>
<h3 id="异性相吸"><a href="#异性相吸" class="headerlink" title="异性相吸"></a>异性相吸</h3><p>这题给的hint很实在，直接告诉你怎么做了：</p>
<ol>
<li>xor    </li>
<li>hex2binary</li>
<li>len(bin(miwen))==len(bin(mingwen))</li>
</ol>
<p>大致就是明文密文的二进制长度相等，正好可以二进制异或，异或后直接转为16进制解码即可</p>
<p><strong>解密脚本</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line">filep=open(<span class="string">"cipher.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">filec=open(<span class="string">"plain.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">plain=<span class="string">''</span>.join(filep.readlines())</span><br><span class="line">cipher=<span class="string">''</span>.join(filec.readlines())</span><br><span class="line"><span class="comment"># print plain</span></span><br><span class="line"><span class="comment"># print cipher</span></span><br><span class="line">str_p=<span class="string">""</span></span><br><span class="line">str_c=<span class="string">""</span></span><br><span class="line">ans=<span class="string">""</span></span><br><span class="line">answer=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">	str_p+=<span class="string">'&#123;:08b&#125;'</span>.format(ord(plain[i]))</span><br><span class="line">	str_c+=<span class="string">'&#123;:08b&#125;'</span>.format(ord(cipher[i]))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">	a=int(str_p[j])</span><br><span class="line">	b=int(str_c[j])</span><br><span class="line">	ans+=str(a^b)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>,<span class="number">4</span>):</span><br><span class="line">	answer+=hex(int(ans[x:x+<span class="number">4</span>],<span class="number">2</span>))[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">print</span> answer.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<p><img src="https://s2.ax1x.com/2019/01/20/kPAeBD.png" alt="kPAeBD.png"></p>
<h3 id="Wiener-Wiener-Chicken-Dinner"><a href="#Wiener-Wiener-Chicken-Dinner" class="headerlink" title="Wiener Wiener Chicken Dinner"></a>Wiener Wiener Chicken Dinner</h3><p>这题可算害苦我了，做了2个小时…思路没有…Google了一下wiener发现是一种RSA的攻击手段，低解密指数攻击，大概的特点就是e特别特别大……</p>
<p>题目给出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag=raw_input(<span class="string">'flag:'</span>)</span><br><span class="line">key=RSA.construct((<span class="number">1063045321283844468344531168992778520651192162100948533991539097447031440090068191835838938460807260866872379834796862916118785271062209281267667069640000501698142693389209275376843382863579650119977059768375028586326490055087394631528241983631462471709913758728591459476799115050977493979613545056736162868049L</span>, <span class="number">837165022918376318972691589160491375229372195625940137121740685432530132860541010174727630660292946071507342455170833392895060048564125597915757582027572284342507277083636059558106672685400173531425920294781499112027917632497954958437660357575400222692979844873372105801998210845285775146263117399191185379347L</span>))</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(key)</span><br><span class="line">cipher_text = base64.b64encode(cipher.encrypt(flag))</span><br><span class="line"><span class="keyword">print</span> cipher_text</span><br><span class="line"><span class="comment">#cipher_text = 'AGgt1h6dudnkeoCr7SFclkYYsYa65KZ8V29bbgbf+BDyjnyx5stCYjcyktat73aHs2EOaMgwGUwj3HwPTvT+T5LHIxM4uTnAgWOui4dnb7vF7QizN0ShY2O1h26CgLnf5I0vQWbY7WCC7kA/orNW7F5yxZiKRAawacS2M5ghP4/Q'</span></span><br></pre></td></tr></table></figure>
<p>不熟悉python的crypto模块和RSA模块的使用，所以直接Google了一下，发现<code>RSA.construct()</code>用于初始化密钥，脚本的意思就是用户自己输入一个flag，用脚本里的n和e构造的公钥加密以后base64一下输出即可；</p>
<p>最后注释给出了cipher_text应该就是要找的flag加密以后base64得到的，所以要对其进行base64解码以后才可以解密；</p>
<p>Crypto模块的RSA加密解密流程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪随机数生成器</span></span><br><span class="line">random_generator = Random.new().read</span><br><span class="line"></span><br><span class="line"><span class="comment"># rsa算法生成实例</span></span><br><span class="line">rsa = RSA.generate(<span class="number">1024</span>, random_generator)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 秘钥对的生成</span></span><br><span class="line">private_pem = rsa.exportKey()</span><br><span class="line">public_pem = rsa.publickey().exportKey()</span><br><span class="line">message = <span class="string">"chenqi"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 公钥加密</span></span><br><span class="line">rsakey = RSA.importKey(public_pem)</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(rsakey)</span><br><span class="line">cipher_text = base64.b64encode(cipher.encrypt(message))</span><br><span class="line"><span class="keyword">print</span> cipher_text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 私钥解密</span></span><br><span class="line">rsakey = RSA.importKey(private_pem)</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(rsakey)</span><br><span class="line">text = cipher.decrypt(base64.b64decode(cipher_text), random_generator)</span><br><span class="line"><span class="keyword">print</span> text</span><br></pre></td></tr></table></figure>
<p>题目的关键点是如何得到私钥d，题目提示是Wiener攻击，那就直接找到github的写好的py脚本直接用就好了，解出d：</p>
<p><a href="https://imgchr.com/i/kPZrvt" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/20/kPZrvt.md.png" alt="kPZrvt.md.png"></a></p>
<p>d找到了以后私钥就知道了，直接在给出的脚本上修改即可，在<code>construct</code>方法最后添加私钥即可生成RSA算法的解密私钥，直接按照流程decode就好了：</p>
<p><strong>解密脚本：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">random_generator=Random.new().read</span><br><span class="line"><span class="comment"># flag=raw_input('flag:')</span></span><br><span class="line">key=RSA.construct((<span class="number">1063045321283844468344531168992778520651192162100948533991539097447031440090068191835838938460807260866872379834796862916118785271062209281267667069640000501698142693389209275376843382863579650119977059768375028586326490055087394631528241983631462471709913758728591459476799115050977493979613545056736162868049L</span>, <span class="number">837165022918376318972691589160491375229372195625940137121740685432530132860541010174727630660292946071507342455170833392895060048564125597915757582027572284342507277083636059558106672685400173531425920294781499112027917632497954958437660357575400222692979844873372105801998210845285775146263117399191185379347L</span>,<span class="number">57899763801722261062891290503559835904571946557258761154422546104824094670843</span>))</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(key)</span><br><span class="line"><span class="comment"># cipher_text = base64.b64encode(cipher.encrypt(flag))</span></span><br><span class="line"><span class="comment"># print cipher_text</span></span><br><span class="line">cipher_text = <span class="string">'AGgt1h6dudnkeoCr7SFclkYYsYa65KZ8V29bbgbf+BDyjnyx5stCYjcyktat73aHs2EOaMgwGUwj3HwPTvT+T5LHIxM4uTnAgWOui4dnb7vF7QizN0ShY2O1h26CgLnf5I0vQWbY7WCC7kA/orNW7F5yxZiKRAawacS2M5ghP4/Q'</span></span><br><span class="line">text = cipher.decrypt(base64.b64decode(cipher_text), random_generator)</span><br><span class="line"><span class="keyword">print</span> text</span><br></pre></td></tr></table></figure>
<p>运行得到flag：</p>
<p><a href="https://imgchr.com/i/kPeFaD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/20/kPeFaD.md.png" alt="kPeFaD.md.png"></a></p>
<p>参考链接：<a href="https://www.cnblogs.com/chenny7/p/7693334.html" target="_blank" rel="noopener">py的crypto模块如何进行RSA加密解密</a>，<a href="https://github.com/pablocelayes/rsa-wiener-attack" target="_blank" rel="noopener">Wiener-tools</a>，<a href="https://www.anquanke.com/post/id/84632" target="_blank" rel="noopener">RSA攻击总结干货</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Gard3nia</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://gardenia30.top/2018/11/09/南京邮电大学CTF平台Writeup/">https://gardenia30.top/2018/11/09/南京邮电大学CTF平台Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Writeup/">Writeup</a><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/Misc/">Misc</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/11/30/BugkuCTF代码审计writeup/"><i class="fa fa-chevron-left">  </i><span>BugkuCTF代码审计Writeup</span></a></div><div class="next-post pull-right"><a href="/2018/11/08/递归与分治/"><span>递归与分治</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By Gard3nia</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Just keep moving!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>