<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="密码学学习笔记"><meta name="keywords" content="Crypto"><meta name="author" content="Gard3nia"><meta name="copyright" content="Gard3nia"><title>密码学学习笔记 | Gard3nia's Notebook</title><link rel="shortcut icon" href="/rea.jpg"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#古典密码仿射"><span class="toc-number">2.</span> <span class="toc-text">古典密码仿射</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#简述"><span class="toc-number">2.1.</span> <span class="toc-text">简述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码分析"><span class="toc-number">2.2.</span> <span class="toc-text">代码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#加密算法"><span class="toc-number">2.2.1.</span> <span class="toc-text">加密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#判断最大公因数"><span class="toc-number">2.2.2.</span> <span class="toc-text">判断最大公因数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密算法"><span class="toc-number">2.2.3.</span> <span class="toc-text">解密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#完整代码"><span class="toc-number">2.2.4.</span> <span class="toc-text">完整代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行结果及正确性"><span class="toc-number">2.3.</span> <span class="toc-text">运行结果及正确性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安全性分析"><span class="toc-number">2.4.</span> <span class="toc-text">安全性分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#对称加密DES"><span class="toc-number">3.</span> <span class="toc-text">对称加密DES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#加密原理"><span class="toc-number">3.1.</span> <span class="toc-text">加密原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#密钥生成"><span class="toc-number">3.1.1.</span> <span class="toc-text">密钥生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加密处理"><span class="toc-number">3.1.2.</span> <span class="toc-text">加密处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F函数"><span class="toc-number">3.1.3.</span> <span class="toc-text">F函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#加密详细过程"><span class="toc-number">3.2.</span> <span class="toc-text">加密详细过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#各个置换dict"><span class="toc-number">3.2.1.</span> <span class="toc-text">各个置换dict</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#初始IP置换"><span class="toc-number">3.2.2.</span> <span class="toc-text">初始IP置换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串的循环左移"><span class="toc-number">3.2.3.</span> <span class="toc-text">字符串的循环左移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#密钥初始编排-PC1"><span class="toc-number">3.2.4.</span> <span class="toc-text">密钥初始编排-PC1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#密钥二次编排-PC2"><span class="toc-number">3.2.5.</span> <span class="toc-text">密钥二次编排-PC2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#按位异或"><span class="toc-number">3.2.6.</span> <span class="toc-text">按位异或</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#E盒扩展"><span class="toc-number">3.2.7.</span> <span class="toc-text">E盒扩展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#S盒处理"><span class="toc-number">3.2.8.</span> <span class="toc-text">S盒处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P盒置换"><span class="toc-number">3.2.9.</span> <span class="toc-text">P盒置换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成16个子密钥"><span class="toc-number">3.2.10.</span> <span class="toc-text">生成16个子密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F函数-1"><span class="toc-number">3.2.11.</span> <span class="toc-text">F函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP逆置换"><span class="toc-number">3.2.12.</span> <span class="toc-text">IP逆置换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加密一组"><span class="toc-number">3.2.13.</span> <span class="toc-text">加密一组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加密全部"><span class="toc-number">3.2.14.</span> <span class="toc-text">加密全部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密一组"><span class="toc-number">3.2.15.</span> <span class="toc-text">解密一组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密全部"><span class="toc-number">3.2.16.</span> <span class="toc-text">解密全部</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行结果及正确性分析"><span class="toc-number">3.3.</span> <span class="toc-text">运行结果及正确性分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#算法安全性分析"><span class="toc-number">3.4.</span> <span class="toc-text">算法安全性分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有效性和合理性分析"><span class="toc-number">3.5.</span> <span class="toc-text">有效性和合理性分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#算法编写过程中遇到的问题及解决"><span class="toc-number">3.6.</span> <span class="toc-text">算法编写过程中遇到的问题及解决</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#序列密码笔记"><span class="toc-number">4.</span> <span class="toc-text">序列密码笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#序列密码简单叙述"><span class="toc-number">4.1.</span> <span class="toc-text">序列密码简单叙述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#序列密码加密解密过程"><span class="toc-number">4.2.</span> <span class="toc-text">序列密码加密解密过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#序列密码的分类"><span class="toc-number">4.3.</span> <span class="toc-text">序列密码的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-同步序列密码"><span class="toc-number">4.3.1.</span> <span class="toc-text">1.同步序列密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-自同步序列密码"><span class="toc-number">4.3.2.</span> <span class="toc-text">2.自同步序列密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线性反馈移位寄存器"><span class="toc-number">4.4.</span> <span class="toc-text">线性反馈移位寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#概述"><span class="toc-number">4.4.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#游程"><span class="toc-number">4.4.2.</span> <span class="toc-text">游程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移位寄存器"><span class="toc-number">4.4.3.</span> <span class="toc-text">移位寄存器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#反馈移位寄存器-FSR"><span class="toc-number">4.4.4.</span> <span class="toc-text">反馈移位寄存器(FSR)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线性反馈移位寄存器（LFSR）"><span class="toc-number">4.4.5.</span> <span class="toc-text">线性反馈移位寄存器（LFSR）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#序列密码RC4"><span class="toc-number">5.</span> <span class="toc-text">序列密码RC4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#序列密码之RC4算法"><span class="toc-number">5.1.</span> <span class="toc-text">序列密码之RC4算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简述-1"><span class="toc-number">5.1.1.</span> <span class="toc-text">简述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码分析-1"><span class="toc-number">5.1.2.</span> <span class="toc-text">代码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#初始化S盒和T向量（初始化S和T）"><span class="toc-number">5.1.2.1.</span> <span class="toc-text">初始化S盒和T向量（初始化S和T）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#KSA密钥调度算法（置换S）"><span class="toc-number">5.1.2.2.</span> <span class="toc-text">KSA密钥调度算法（置换S）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PRGA伪随机生成算法（生成密钥流）"><span class="toc-number">5.1.2.3.</span> <span class="toc-text">PRGA伪随机生成算法（生成密钥流）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加密"><span class="toc-number">5.1.2.4.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解密"><span class="toc-number">5.1.2.5.</span> <span class="toc-text">解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#完整代码-1"><span class="toc-number">5.1.2.6.</span> <span class="toc-text">完整代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行结果及正确性-1"><span class="toc-number">5.1.3.</span> <span class="toc-text">运行结果及正确性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安全性分析-1"><span class="toc-number">5.1.4.</span> <span class="toc-text">安全性分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有效性和合理性分析-1"><span class="toc-number">5.1.5.</span> <span class="toc-text">有效性和合理性分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法编写过程中遇到的问题及解决-1"><span class="toc-number">5.1.6.</span> <span class="toc-text">算法编写过程中遇到的问题及解决</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#非对称加密RSA"><span class="toc-number">6.</span> <span class="toc-text">非对称加密RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#简述-2"><span class="toc-number">6.1.</span> <span class="toc-text">简述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#公钥与私钥的产生"><span class="toc-number">6.2.</span> <span class="toc-text">公钥与私钥的产生</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#消息加密"><span class="toc-number">6.3.</span> <span class="toc-text">消息加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#消息解密"><span class="toc-number">6.4.</span> <span class="toc-text">消息解密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码分析-2"><span class="toc-number">6.5.</span> <span class="toc-text">代码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#生成n字节的随机数"><span class="toc-number">6.5.1.</span> <span class="toc-text">生成n字节的随机数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第一次素性检验"><span class="toc-number">6.5.2.</span> <span class="toc-text">第一次素性检验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二次素性检验"><span class="toc-number">6.5.3.</span> <span class="toc-text">第二次素性检验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过两次素性检测"><span class="toc-number">6.5.4.</span> <span class="toc-text">通过两次素性检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#产生公钥e"><span class="toc-number">6.5.5.</span> <span class="toc-text">产生公钥e</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16进制编码"><span class="toc-number">6.5.6.</span> <span class="toc-text">16进制编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16进制解码"><span class="toc-number">6.5.7.</span> <span class="toc-text">16进制解码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分组加密一组"><span class="toc-number">6.5.8.</span> <span class="toc-text">分组加密一组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加密全部-1"><span class="toc-number">6.5.9.</span> <span class="toc-text">加密全部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密一组-1"><span class="toc-number">6.5.10.</span> <span class="toc-text">解密一组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密全部-1"><span class="toc-number">6.5.11.</span> <span class="toc-text">解密全部</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行结果及正确性验证"><span class="toc-number">6.6.</span> <span class="toc-text">运行结果及正确性验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安全性分析-2"><span class="toc-number">6.7.</span> <span class="toc-text">安全性分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA的共模攻击分析"><span class="toc-number">6.7.1.</span> <span class="toc-text">RSA的共模攻击分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#攻击原理"><span class="toc-number">6.7.1.0.1.</span> <span class="toc-text">攻击原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#实例分析"><span class="toc-number">6.7.1.0.2.</span> <span class="toc-text">实例分析</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有效性和合理性分析-2"><span class="toc-number">6.8.</span> <span class="toc-text">有效性和合理性分析</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gard3nia</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">13</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">17</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">9</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">friendlinks</div><a class="author-info-links__name text-center" href="https://skysec.top">一叶飘零学长</a><a class="author-info-links__name text-center" href="https://0verwatch.top/">0verwatch</a><a class="author-info-links__name text-center" href="http://chaosec.top/">瑞雪师傅</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://s2.ax1x.com/2019/05/26/VE5mHf.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gard3nia's Notebook</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">时间轴</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">归档</a><a class="site-page" href="/about">简介</a></span></div><div id="post-info"><div id="post-title">密码学学习笔记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-13</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/密码学学习/">密码学学习</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">8.1k</span><span class="post-meta__separator">|</span><span>Reading time: 33 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>终于放假了，整理一波之前密码学笔记和课程设计<a id="more"></a>；</p>
<h1 id="古典密码仿射"><a href="#古典密码仿射" class="headerlink" title="古典密码仿射"></a>古典密码仿射</h1><h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>仿射密码，是古典密码里面比较经典的替换密码，在我看来就是将移位密码和数乘密码结合到了一起；</p>
<p>加密方程：<code>C=(k1*M+k2)mod26</code>；</p>
<p>解密方程：<code>M=(C-k2)*(k1^-1)mod26</code>；</p>
<p>其中k1必须与26互素，这样才可以产生k1的逆元用于解密；没有对k1的限制，可能无法解密。</p>
<h2 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h2><h3 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h3><p>这里的p为需要加密的明文，k1,k2就是上述的两个密钥，先看明文需要加密几个字母，有几个字母就产生几轮循环，每次循环将字母先转换为0~25的数字，然后进行数乘和移位变换，然后再转换为字符，存储在一个字符变量c中，直到循环结束为止，这就得到了密文；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#仿射加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fangshe</span><span class="params">(p,k1,k2)</span>:</span></span><br><span class="line">	c=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(p)):</span><br><span class="line">		temp=chr((((ord(p[i])-ord(<span class="string">'a'</span>))*k1+k2)%<span class="number">26</span>)+ord(<span class="string">'a'</span>))</span><br><span class="line">		c+=temp</span><br><span class="line">	<span class="keyword">return</span> c</span><br></pre></td></tr></table></figure>
<h3 id="判断最大公因数"><a href="#判断最大公因数" class="headerlink" title="判断最大公因数"></a>判断最大公因数</h3><p>如果需要解密，则必须要使得k1能够产生对26的逆元，即要使k1和26互素，所以判断k1和26是否最大公约数为1;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#判断最大公因数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(x,y)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> x&gt;y:</span><br><span class="line">		temp=y</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		temp=x</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,temp+<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">if</span>((x%i==<span class="number">0</span>) <span class="keyword">and</span> (y%i==<span class="number">0</span>)):</span><br><span class="line">			s=i</span><br><span class="line">	<span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>
<h3 id="解密算法"><a href="#解密算法" class="headerlink" title="解密算法"></a>解密算法</h3><p>解密首先要判断k1和26是否互素，互素才可以解密，在互素的前提下计算k1对于26的逆元：k1_re，然后用解密放生进行循环解密即可输出明文；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#仿射解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(a,b,str1)</span>:</span></span><br><span class="line">	c1=<span class="string">""</span></span><br><span class="line">	<span class="keyword">if</span>(gcd(a,<span class="number">26</span>)==<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">			<span class="keyword">if</span>((a*i)%<span class="number">26</span>==<span class="number">1</span>):</span><br><span class="line">				k1_re=i</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">			temp=chr((((ord(str1[i])-ord(<span class="string">'a'</span>))-b)*k1_re)%<span class="number">26</span>+ord(<span class="string">'a'</span>))</span><br><span class="line">			c1+=temp</span><br><span class="line">		<span class="keyword">return</span> c1</span><br></pre></td></tr></table></figure>
<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><p>刚写python，比较丑……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#仿射加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fangshe</span><span class="params">(p,k1,k2)</span>:</span></span><br><span class="line">	c=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(p)):</span><br><span class="line">		temp=chr((((ord(p[i])-ord(<span class="string">'a'</span>))*k1+k2)%<span class="number">26</span>)+ord(<span class="string">'a'</span>))</span><br><span class="line">		c+=temp</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"><span class="comment">#判断最大公因数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(x,y)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> x&gt;y:</span><br><span class="line">		temp=y</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		temp=x</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,temp+<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">if</span>((x%i==<span class="number">0</span>) <span class="keyword">and</span> (y%i==<span class="number">0</span>)):</span><br><span class="line">			s=i</span><br><span class="line">	<span class="keyword">return</span> s</span><br><span class="line"><span class="comment">#仿射解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(a,b,str1)</span>:</span></span><br><span class="line">	c1=<span class="string">""</span></span><br><span class="line">	<span class="keyword">if</span>(gcd(a,<span class="number">26</span>)==<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">			<span class="keyword">if</span>((a*i)%<span class="number">26</span>==<span class="number">1</span>):</span><br><span class="line">				k1_re=i</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">			temp=chr((((ord(str1[i])-ord(<span class="string">'a'</span>))-b)*k1_re)%<span class="number">26</span>+ord(<span class="string">'a'</span>))</span><br><span class="line">			c1+=temp</span><br><span class="line">		<span class="keyword">return</span> c1</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" EncryptInput "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	p=raw_input(<span class="string">"Please enter the plain:"</span>)</span><br><span class="line">	k1=input(<span class="string">"Please enter k1:"</span>)</span><br><span class="line">	k2=input(<span class="string">"Please enter k2:"</span>)</span><br><span class="line">	<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" Encryption "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	c=fangshe(p,k1,k2)</span><br><span class="line">	<span class="keyword">print</span> (<span class="string">"Cipher:"</span>+c)</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"\n"</span>+<span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" DecryptInput "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	C=raw_input(<span class="string">"Please enter the Cipher:"</span>)</span><br><span class="line">	key1=input(<span class="string">"Please enter k1:"</span>)</span><br><span class="line">	key2=input(<span class="string">"Please enter k2:"</span>)</span><br><span class="line">	<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" Decryption "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	plain=decode(key1,key2,C)</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"Plain:"</span>+plain</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<h2 id="运行结果及正确性"><a href="#运行结果及正确性" class="headerlink" title="运行结果及正确性"></a>运行结果及正确性</h2><p>输入明文hellocumt，k1=7,k2=2加密所得的密文用仿射解密得出原来的明文，所以正确性得到验证</p>
<p><img src="https://s2.ax1x.com/2019/01/02/FIEyNt.png" alt="结果"></p>
<h2 id="安全性分析"><a href="#安全性分析" class="headerlink" title="安全性分析"></a>安全性分析</h2><p>1.仿射密码对于任意两个不同的字母，其最后得到的密文肯定不一样；所以当密文长度足够长时，我们可以使用频率分析的方法来解决。利用仿射密码时，一般只有 26 个字母，而不大于 26 的与 26 互素的个数一共有12个，算上偏移量，也就是大概12x26=312种可能性。</p>
<p>一般来说，对于该种密码，至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。</p>
<p>已知部分明密文对：<code>y1=(ax1+b)mod26</code>     <code>y2=(ax2+b)(mod26)</code>   </p>
<p>两式相减：<code>y1−y2=a(x1−x2)(mod26)</code>很容易得到a，得到了a即可解出b</p>
<p>2.对密文直接用312个密钥空间进行暴破，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line">plain=<span class="string">"zebbwqmif"</span></span><br><span class="line">c=<span class="string">""</span></span><br><span class="line">k=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">23</span>,<span class="number">25</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">		c=<span class="string">""</span></span><br><span class="line">		<span class="keyword">for</span> x <span class="keyword">in</span> range(len(plain)):</span><br><span class="line">			res=chr((ord(plain[x])-ord(<span class="string">'a'</span>)-j)*k[i]%<span class="number">26</span>+ord(<span class="string">'a'</span>))</span><br><span class="line">			c+=res</span><br><span class="line">		<span class="keyword">print</span> c<span class="comment">#+'\n'</span></span><br><span class="line">		<span class="keyword">if</span> c==<span class="string">"hellocumt"</span>:</span><br><span class="line">			<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">"find it"</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br></pre></td></tr></table></figure>
<p>运行结果：找到有意义的密文</p>
<p><img src="https://s2.ax1x.com/2019/01/13/FvvqPA.png" alt="FvvqPA.png"></p>
<h1 id="对称加密DES"><a href="#对称加密DES" class="headerlink" title="对称加密DES"></a>对称加密DES</h1><h2 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h2><p><img src="https://s2.ax1x.com/2019/01/03/FoEdsg.md.png" alt="FoEdsg.md.png"></p>
<h3 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h3><p>1.输入8位字符密钥转换为64位二进制；</p>
<p>2.经过64位密钥经过PC-1置换为56位；</p>
<p>3.将56位分成两部分分别进行循环左移；</p>
<p>4.左移后组合，再进入PC-2置换为48位，第一轮密钥生成结束；</p>
<p>5.循环左移以后的两部分继续循环左移，再次进入PC-2置换，生成48位子密钥，如此进行16轮，存储16个48位的子密钥</p>
<h3 id="加密处理"><a href="#加密处理" class="headerlink" title="加密处理"></a>加密处理</h3><p>1.输入的字符先转换为二进制，每64位为一组进行加密；</p>
<p>2.每一组64位的二进制先进行IP置换打乱；</p>
<p>3.然后将64位分成2部分，分别放入Li和Ri</p>
<p>4.将Ri经过F函数处理，再与Li异或，然后将值赋给R(i+1)</p>
<p>5.将Ri赋值给L(i+1)</p>
<p>6.最后一轮，直接将Ri赋给R(i+1),再将Ri经过F函数处理，再与Li异或，然后将值赋给L(i+1)</p>
<p>7.将L和R合并后经过逆IP盒，得到密文C</p>
<h3 id="F函数"><a href="#F函数" class="headerlink" title="F函数"></a>F函数</h3><p>1.先将输入的32位Ri进行扩展置换E，转换为48位</p>
<p>2.再与生成的子密钥进行异或</p>
<p>3.将异或后的值经过S盒压缩为32位</p>
<p>4.再进行P置换打乱顺序</p>
<h2 id="加密详细过程"><a href="#加密详细过程" class="headerlink" title="加密详细过程"></a>加密详细过程</h2><h3 id="各个置换dict"><a href="#各个置换dict" class="headerlink" title="各个置换dict"></a>各个置换dict</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dic_IP=[<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">dic_key1=[<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">dic_key2=[<span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">dic_e=[<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">dic_s=[[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>],[<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>],[<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>],[<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>],[<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>],[<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>],[<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]]</span><br><span class="line"></span><br><span class="line">dic_p=[<span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span>]</span><br><span class="line"></span><br><span class="line">dic_n=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">dic_IP2=[<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,<span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,<span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>]</span><br></pre></td></tr></table></figure>
<h3 id="初始IP置换"><a href="#初始IP置换" class="headerlink" title="初始IP置换"></a>初始IP置换</h3><p>将初始明文字符转换为64位二进制，并进行第一次IP置换。</p>
<p>需要注意的就是在python中用format函数非常方便，没有bin函数开头的0b,在这里需要将转换的二进制字符补足8位（在左边补0即可）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_p</span><span class="params">(p)</span>:</span></span><br><span class="line">	s1=<span class="string">""</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">		b=<span class="string">'&#123;:08b&#125;'</span>.format(ord(p[i]))</span><br><span class="line">		s1+=b</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">		res+=s1[dic_IP[i]<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="字符串的循环左移"><a href="#字符串的循环左移" class="headerlink" title="字符串的循环左移"></a>字符串的循环左移</h3><p>生成16个子密钥时需要循环左移函数，使用到的就是py的切片，先需要对密钥56位分为两部分，分别28位，然后这两部分分别循环左移</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zuoyi</span><span class="params">(n,ki)</span>:</span></span><br><span class="line">	temp=ki[n:len(ki)]</span><br><span class="line">	temp=temp+ki[<span class="number">0</span>:n]</span><br><span class="line">	<span class="keyword">return</span> temp</span><br></pre></td></tr></table></figure>
<h3 id="密钥初始编排-PC1"><a href="#密钥初始编排-PC1" class="headerlink" title="密钥初始编排-PC1"></a>密钥初始编排-PC1</h3><p>需要对输入的8个字符进行二进制转换并补足64位，然后将这64位字符进行PC-1置换，从64位置换为56位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_pc_1</span><span class="params">(k)</span>:</span></span><br><span class="line">	k1=<span class="string">""</span></span><br><span class="line">	k2=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">		b=<span class="string">'&#123;:08b&#125;'</span>.format(ord(k[i]))</span><br><span class="line">		k1+=b                            </span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">56</span>):</span><br><span class="line">		k2+=k1[dic_key1[i]<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> k2</span><br></pre></td></tr></table></figure>
<h3 id="密钥二次编排-PC2"><a href="#密钥二次编排-PC2" class="headerlink" title="密钥二次编排-PC2"></a>密钥二次编排-PC2</h3><p>将每次循环左移的密钥组合后进行PC-2置换，由56位转换为48位，并存储</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_pc_2</span><span class="params">(k)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">		res+=k[dic_key2[i]<span class="number">-1</span>]            <span class="comment">#将56位转换为48位</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="按位异或"><a href="#按位异或" class="headerlink" title="按位异或"></a>按位异或</h3><p>两个相同长度的字符进行按位异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(r_e,ki)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(r_e)):</span><br><span class="line">		xor_res=int(r_e[i],<span class="number">10</span>)^int(ki[i],<span class="number">10</span>)</span><br><span class="line">		<span class="keyword">if</span> xor_res==<span class="number">1</span>:</span><br><span class="line">			res+=<span class="string">"1"</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			res+=<span class="string">"0"</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="E盒扩展"><a href="#E盒扩展" class="headerlink" title="E盒扩展"></a>E盒扩展</h3><p>将转换为二进制的64位明文分成两部分，Li和Ri，需要将Ri从32位二进制置换为48位，需要经过E盒扩展</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_e</span><span class="params">(r)</span>:</span></span><br><span class="line">	temp_r=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">		temp_r+=(r[dic_e[i]<span class="number">-1</span>])          <span class="comment">#将32位扩展为48位</span></span><br><span class="line">	<span class="keyword">return</span> temp_r</span><br></pre></td></tr></table></figure>
<h3 id="S盒处理"><a href="#S盒处理" class="headerlink" title="S盒处理"></a>S盒处理</h3><p>这里有8个S盒，从E盒出来的48位数据分为8组，每组6位，分别进入8个S盒，上面将这8个S盒分别装入列表，并将这8个列表装入一个大列表，类似于C++里的二维数组。</p>
<p>将6位中的首位和末位组合并转换为10进制，为行</p>
<p>将6位中剩下的4位组合转换为10进制，为列</p>
<p>查找到对应行列的S盒中的值，将其转换为二进制字符并存储在res中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_s</span><span class="params">(r)</span>:</span></span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(r),<span class="number">6</span>):                     <span class="comment">#步长为6</span></span><br><span class="line">		begins=r[i:i+<span class="number">6</span>]</span><br><span class="line">		hang=int(begins[<span class="number">0</span>]+begins[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">		lie=int(begins[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">		num=<span class="string">'&#123;:04b&#125;'</span>.format(dic_s[j][<span class="number">16</span>*hang+lie])  <span class="comment">#将s盒中对应数字转为二进制字符串并补满4位</span></span><br><span class="line">		res+=num</span><br><span class="line">		j=j+<span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="P盒置换"><a href="#P盒置换" class="headerlink" title="P盒置换"></a>P盒置换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_p</span><span class="params">(r)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">		res+=r[dic_p[i]<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="生成16个子密钥"><a href="#生成16个子密钥" class="headerlink" title="生成16个子密钥"></a>生成16个子密钥</h3><p>64位密钥先经过pc1置换为56位，分成两部分，分别循环左移，组合后进行二次密钥编排，将产生的16个子密钥按序存储在keylist中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_list</span><span class="params">(key)</span>:</span></span><br><span class="line">	temp_1=init_pc_1(key)</span><br><span class="line">	k_l=temp_1[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">	k_r=temp_1[<span class="number">28</span>:<span class="number">56</span>]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">		k_l=zuoyi(dic_n[i],k_l)          <span class="comment">#前28位左移n</span></span><br><span class="line">		k_r=zuoyi(dic_n[i],k_r)          <span class="comment">#后28位左移n</span></span><br><span class="line">		key_yiwei=k_l+k_r</span><br><span class="line">		key_res=init_pc_2(key_yiwei)</span><br><span class="line">		keylist.append(key_res)</span><br></pre></td></tr></table></figure>
<h3 id="F函数-1"><a href="#F函数-1" class="headerlink" title="F函数"></a>F函数</h3><p>先E盒置换，再与子密钥异或，再S盒处理，最后进行P盒处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun_F</span><span class="params">(str1,key)</span>:</span></span><br><span class="line">	res_e=box_e(str1)               </span><br><span class="line">	res_xor=xor(res_e,key)</span><br><span class="line">	res_s=box_s(res_xor)</span><br><span class="line">	res_p=box_p(res_s)</span><br><span class="line">	<span class="keyword">return</span> res_p</span><br></pre></td></tr></table></figure>
<h3 id="IP逆置换"><a href="#IP逆置换" class="headerlink" title="IP逆置换"></a>IP逆置换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span>  <span class="title">IP_NI</span><span class="params">(c)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">		res+=c[dic_IP2[i]<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="加密一组"><a href="#加密一组" class="headerlink" title="加密一组"></a>加密一组</h3><p>8个字符的加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DES_encode_one_group</span><span class="params">(p,k)</span>:</span></span><br><span class="line">	p_bin=init_p(p)        <span class="comment">#str 64</span></span><br><span class="line">	p_left=p_bin[<span class="number">0</span>:<span class="number">32</span>]     <span class="comment">#str 32 left</span></span><br><span class="line">	p_right=p_bin[<span class="number">32</span>:]     <span class="comment">#str 32 right</span></span><br><span class="line">	key_list(k)          <span class="comment">#生成16个子密钥</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>):    <span class="comment">#16轮迭代</span></span><br><span class="line">		p_temp=p_right                  <span class="comment">#暂存</span></span><br><span class="line">		fin_r=fun_F(p_right,keylist[i]) <span class="comment">#Ri经过F函数</span></span><br><span class="line">		p_right=xor(fin_r,p_left)       <span class="comment">#Ri</span></span><br><span class="line">		p_left=p_temp                   <span class="comment">#Li</span></span><br><span class="line">	final_right=p_right</span><br><span class="line">	final_left=xor(fun_F(p_right,keylist[<span class="number">15</span>]),p_left)</span><br><span class="line">	fin=final_left+final_right</span><br><span class="line">	fin=IP_NI(fin)</span><br><span class="line">	<span class="keyword">return</span> fin</span><br></pre></td></tr></table></figure>
<h3 id="加密全部"><a href="#加密全部" class="headerlink" title="加密全部"></a>加密全部</h3><p>8个字符一组进行分组，每组分别进行加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DES_encode</span><span class="params">(p,k)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	i=<span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> p[i:i+<span class="number">8</span>]!=<span class="string">""</span>:</span><br><span class="line">		res+=DES_encode_one_group(p[i:i+<span class="number">8</span>],key)</span><br><span class="line">		i=i+<span class="number">8</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="解密一组"><a href="#解密一组" class="headerlink" title="解密一组"></a>解密一组</h3><p>一组64位二进制进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DES_decode_one_group</span><span class="params">(c)</span>:</span></span><br><span class="line">	cipher=<span class="string">""</span></span><br><span class="line">	<span class="comment">#key_list(k)</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">		cipher+=c[dic_IP[i]<span class="number">-1</span>]        <span class="comment">#c经过IP1置换放入cipher</span></span><br><span class="line">	cipher_left=cipher[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">	cipher_right=cipher[<span class="number">32</span>:]</span><br><span class="line">	i=<span class="number">15</span></span><br><span class="line">	<span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">		cipher_temp=cipher_right</span><br><span class="line">		cipher_right=xor(fun_F(cipher_right,keylist[i]),cipher_left)</span><br><span class="line">		cipher_left=cipher_temp</span><br><span class="line">		i=i<span class="number">-1</span></span><br><span class="line">	fin_right=cipher_right</span><br><span class="line">	fin_left=xor(fun_F(cipher_right,keylist[<span class="number">0</span>]),cipher_left)</span><br><span class="line">	final=fin_left+fin_right</span><br><span class="line">	final=IP_NI(final)</span><br><span class="line">	ming=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">64</span>,<span class="number">8</span>):</span><br><span class="line">		ming+=chr(int(final[x:x+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">	<span class="keyword">return</span> ming</span><br></pre></td></tr></table></figure>
<h3 id="解密全部"><a href="#解密全部" class="headerlink" title="解密全部"></a>解密全部</h3><p>每组64位二进制，分组解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DES_decode</span><span class="params">(c)</span>:</span></span><br><span class="line">	i=<span class="number">0</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">while</span> c[i:i+<span class="number">64</span>]!=<span class="string">""</span>:</span><br><span class="line">		res+=DES_decode_one_group(c[i:i+<span class="number">64</span>])</span><br><span class="line">		i=i+<span class="number">64</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h2 id="运行结果及正确性分析"><a href="#运行结果及正确性分析" class="headerlink" title="运行结果及正确性分析"></a>运行结果及正确性分析</h2><p>输入8个字符作为明文，8个字符作为密钥，得出密文为一串比特流，输入这串比特流，用上面生成的子密钥进行解密得到明文为先前输入的8个明文字符，验证了算法的正确性；</p>
<p><img src="https://s2.ax1x.com/2019/01/02/FI0I41.png" alt="FI0I41.png"></p>
<h2 id="算法安全性分析"><a href="#算法安全性分析" class="headerlink" title="算法安全性分析"></a>算法安全性分析</h2><p>一重DES算法的密钥过短，只有56位有效密钥位，所以不具备很高的安全性，下面分析中间相遇攻击；</p>
<p><strong>中间相遇攻击分析：</strong></p>
<p>在 DES 的基础上，衍生了以下两种加密方式</p>
<p>1.双重 DES，使用两个密钥，长度为112比特，加密方程为<code>C=Ek2(Ek1(P))</code>，但是双重DES是不可以抵抗中间相遇攻击的，构造如下,即分别枚举 K1 和 K2 分别对 P 进行加密和对 C 进行解密。</p>
<p><code>I=Ek1(P)</code>     <code>J=Dk2(C)</code></p>
<p>在我们对 P 进行加密完毕后，可以对加密结果进行排序，当我们对 C 进行解密时，可以每解密一个，就去对应的表中查询，看看是否相等，如此进行中间相遇攻击。计算量大概在2^56左右。和一重DES的复杂度相当；</p>
<p>2.三重DES，加密方式如下，3 个不同的密钥，k1，k2，k3 互相独立，一共 168 比特。可以抵御中间相遇攻击；</p>
<p><code>C=Ek3(Dk2(Ek1(P)))</code>    <code>P=Dk1(Ek2(Dk3(C)))</code></p>
<h2 id="有效性和合理性分析"><a href="#有效性和合理性分析" class="headerlink" title="有效性和合理性分析"></a>有效性和合理性分析</h2><p>DES 现在已经不被视为一种安全的加密算法，拿DES来进行加密已经认为是不合理的，主要原因是它使用的56位密钥过短，为了提供实用所需的安全性，可以使用 DES 的派生算法 三重DES 来进行加密，现在的三重DES是具备安全性的，可以抵抗中间相遇攻击，比较合理有效；</p>
<h2 id="算法编写过程中遇到的问题及解决"><a href="#算法编写过程中遇到的问题及解决" class="headerlink" title="算法编写过程中遇到的问题及解决"></a>算法编写过程中遇到的问题及解决</h2><p>1.算法编写过程中，Feistel网络密码结构中的子密钥每一轮都需要更新；</p>
<p>2.一开始写十六轮迭代时，直接就是写16轮循环，每次得到的R作为下次加密的L，而上一轮得到的异或结果作为R，这样得到的结果是错误的，因为Feistel网络密码结构中第16轮迭代时，右部分直接就是第十五轮得到的R15,左部分是R15经过F函数后与L15异或得到的，并不是简单的16轮重复迭代；</p>
<p>3.一开始的解密过程错误，是因为我直接简单的拿加密的算法当解密的算法了，没有观察到，解密时的每一轮迭代中，子密钥是从第16个到第1个倒序添加的，这点格外重要；</p>
<h1 id="序列密码笔记"><a href="#序列密码笔记" class="headerlink" title="序列密码笔记"></a>序列密码笔记</h1><h2 id="序列密码简单叙述"><a href="#序列密码简单叙述" class="headerlink" title="序列密码简单叙述"></a>序列密码简单叙述</h2><p>序列密码属于对称加密；它的加密用一个随机序列(密钥流)与明文序列按位加密产生密文，用同一随机序列与密文序列叠加来恢复明文序列密码为对称加密，一次只对明文消息的单个bit进行加密解密；一般密钥流的长度等于需要加密的密文的长度</p>
<p><a href="https://imgchr.com/i/F4zDhj" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/01/F4zDhj.md.png" alt="F4zDhj.md.png"></a></p>
<p><strong>特点：</strong></p>
<ol>
<li>加解密运算只是简单的模二加（异或）运算</li>
<li>密码强度主要靠密钥流的随机性</li>
</ol>
<h2 id="序列密码加密解密过程"><a href="#序列密码加密解密过程" class="headerlink" title="序列密码加密解密过程"></a>序列密码加密解密过程</h2><p>1.密钥流产生于种子密钥，种子密钥K通过密钥流发生器产生密钥流<code>k=k0k1k2k3...kn-1</code></p>
<p>2.明文序列为<code>M=m0m1m2m3...m(n-1)</code></p>
<p>3.接下来就是K与M逐位异或得到C的序列<img src="https://s1.ax1x.com/2018/12/24/F6IdrF.png" alt="img"></p>
<p>4.解密不必多说，只要异或回去就好<img src="https://s1.ax1x.com/2018/12/24/F6Ifqe.png" alt="img"></p>
<p><strong>具体实现的流程图：</strong></p>
<p><img src="https://s1.ax1x.com/2018/12/24/F6IIIA.png" alt="img"></p>
<h2 id="序列密码的分类"><a href="#序列密码的分类" class="headerlink" title="序列密码的分类"></a>序列密码的分类</h2><h3 id="1-同步序列密码"><a href="#1-同步序列密码" class="headerlink" title="1.同步序列密码"></a>1.同步序列密码</h3><p>所谓同步序列密码指的是：密钥序列的产生独立于明文消息和密文消息；</p>
<p><strong>加密过程如下:</strong></p>
<p><img src="https://s1.ax1x.com/2018/12/24/F6TD91.png" alt="img"></p>
<p><code>f是状态函数，和密钥源产生必要得状态参数，g是产生密钥序列ki的函数，E是将ki与mi结合输出ci的函数</code></p>
<p><strong>模型：</strong></p>
<p><img src="https://s2.ax1x.com/2019/01/01/F4zC0U.png" alt="F4zC0U.png"><img src="https://s2.ax1x.com/2019/01/01/F4zP7F.png" alt="F4zP7F.png"></p>
<p><strong>特点：</strong></p>
<p>1.无错误传播：各符号之间真正独立。一个传播错误只影响一个符号，不会影响到后继的符号</p>
<p>2.同步：发送方和接收方必须保持精确的、用同样的密钥并作用在同样的位置上，才能正确的解密</p>
<h3 id="2-自同步序列密码"><a href="#2-自同步序列密码" class="headerlink" title="2.自同步序列密码"></a>2.自同步序列密码</h3><p>发双方中的任何一方，其密钥流的产生依赖于密文流；</p>
<p><strong>加密过程：</strong></p>
<p><a href="https://imgchr.com/i/F4zunK" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/01/F4zunK.md.png" alt="F4zunK.md.png"></a></p>
<p><strong>模型：</strong></p>
<p><img src="https://s2.ax1x.com/2019/01/01/F4zM7D.png" alt="加密.png"><img src="https://s2.ax1x.com/2019/01/01/F4zlAe.png" alt="解密.png"></p>
<p><strong>特点：</strong></p>
<p>1.有限错误传播：设密钥序列产生器具有n位存储，则一个符号的传输错误只影响到后面n符号的解密</p>
<p>2.自同步：只要接收方连续收到n个正确的密文符号，密钥序列产生器便会自动地恢复同步 </p>
<p>3.消除明文统计特性</p>
<h2 id="线性反馈移位寄存器"><a href="#线性反馈移位寄存器" class="headerlink" title="线性反馈移位寄存器"></a>线性反馈移位寄存器</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>1.可以产生具有良好伪随机性的序列如：m序列，所以在序列密码中作为密钥序列的驱动序列</p>
<p>2.一个线性反馈移位寄存器由两部分组成：<strong>移位寄存器+反馈函数</strong></p>
<h3 id="游程"><a href="#游程" class="headerlink" title="游程"></a>游程</h3><p>游程就是指连续的1或0序列，游程长度是指连续的1或0序列的长度；</p>
<h3 id="移位寄存器"><a href="#移位寄存器" class="headerlink" title="移位寄存器"></a>移位寄存器</h3><p>移位寄存器是指有n个寄存器（称为n级移位寄存器）<code>r1,r2,…,rn</code>从右到左排列，每个寄存器中能存放1位二进制数，所有寄存器中的数可以统一向右（或向左）移动1位，称为进动1拍。即<code>r1</code>的值<code>(b1)</code>右移1位后输出，然后<code>r2</code>的值<code>(b2)</code>送<code>r1</code> ,<code>r3</code>的值<code>(b3)</code>送<code>r2</code>,……最后，<code>rn</code>的值<code>(bn)</code>送<code>rn-1</code></p>
<p><img src="https://s2.ax1x.com/2019/01/01/F5FfMj.png" alt="F5FfMj.png"></p>
<h3 id="反馈移位寄存器-FSR"><a href="#反馈移位寄存器-FSR" class="headerlink" title="反馈移位寄存器(FSR)"></a>反馈移位寄存器(FSR)</h3><p>反馈移位寄存器(feedback shift register,FSR)是由n位的寄存器和反馈函数(feedback function)组成，n位的寄存器中的初始值称为移位寄存器的初态</p>
<p><img src="https://s2.ax1x.com/2019/01/01/F5F4Ln.png" alt="F5F4Ln.png"></p>
<h3 id="线性反馈移位寄存器（LFSR）"><a href="#线性反馈移位寄存器（LFSR）" class="headerlink" title="线性反馈移位寄存器（LFSR）"></a>线性反馈移位寄存器（LFSR）</h3><p>LFSR是一种特殊的FSR，其反馈函数是移位寄存器中某些位的异或，参与运算的这些位叫做<strong><em>抽头位</em></strong>；</p>
<p><strong>特征：</strong></p>
<p>1.n级LFSR的有效状态为<code>(2^n)-1</code>（全0状态除外，因全0状态的输出序列一直为全0），也即理论上能够产生周期为<code>(2^n)-1</code>的伪随机序列。但要产生最大周期的输出序列，抽头位有一定要求;</p>
<p>2.为了使LFSR得到最大的周期(2^n)-1，其生成多项式（由抽头序列加上常数1形成的多项式）要是本原多项式，这样生成的序列叫做m序列</p>
<p><strong>本原多项式：</strong></p>
<p><a href="https://imgchr.com/i/F5AoCT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/01/01/F5AoCT.md.png" alt="F5AoCT.md.png"></a><br><strong>加解密：</strong></p>
<p>一个LFSR可以生成足够长的密钥二进制序列加密明文二进制序列，要解密密文，只需要运行具有相同初始状态的LFSR即可。</p>
<h1 id="序列密码RC4"><a href="#序列密码RC4" class="headerlink" title="序列密码RC4"></a>序列密码RC4</h1><h2 id="序列密码之RC4算法"><a href="#序列密码之RC4算法" class="headerlink" title="序列密码之RC4算法"></a>序列密码之RC4算法</h2><h3 id="简述-1"><a href="#简述-1" class="headerlink" title="简述"></a>简述</h3><p>在密码学中，<strong>RC4</strong>是一种流加密算法，密钥长度可变。它加解密使用相同的密钥，因此也属于对称加密算法。RC4软件容易实现，密钥长度可变，简单，但也很有效果。RC4 算法广泛应用于 SSL/TLS 协议和 WEP/WPA 协议。</p>
<h3 id="代码分析-1"><a href="#代码分析-1" class="headerlink" title="代码分析"></a>代码分析</h3><p>RC4主要分为三个步骤，初始化 S 和 T 数组，初始化置换 S，生成密钥流。</p>
<h4 id="初始化S盒和T向量（初始化S和T）"><a href="#初始化S盒和T向量（初始化S和T）" class="headerlink" title="初始化S盒和T向量（初始化S和T）"></a>初始化S盒和T向量（初始化S和T）</h4><p>先初始化S，同时建立一个临时数组向量T，如果种子密钥的长度为256字节，则直接将K赋值给T，否则若种子密钥K的长度小于256，则将K的值赋给T的前|K|个元素，并不断重复加载K的值直到T被填满。将S和T分别存储在列表S1和T1里；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_S_T</span><span class="params">(s1,t1,k1)</span>:</span>    </span><br><span class="line">	<span class="string">"""初始化S,T"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">		s1.append(i)</span><br><span class="line">		t1.append(k1[i%len(k1)])</span><br></pre></td></tr></table></figure>
<h4 id="KSA密钥调度算法（置换S）"><a href="#KSA密钥调度算法（置换S）" class="headerlink" title="KSA密钥调度算法（置换S）"></a>KSA密钥调度算法（置换S）</h4><p>用来打乱S盒的初始排列顺序；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_s</span><span class="params">(s2,t2)</span>:</span></span><br><span class="line">	<span class="string">"""更新S"""</span></span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">		j=(j+s2[i]+t2[i])%<span class="number">256</span></span><br><span class="line">		s2[i],s2[j]=s2[j],s2[i]</span><br></pre></td></tr></table></figure>
<h4 id="PRGA伪随机生成算法（生成密钥流）"><a href="#PRGA伪随机生成算法（生成密钥流）" class="headerlink" title="PRGA伪随机生成算法（生成密钥流）"></a>PRGA伪随机生成算法（生成密钥流）</h4><p>生成密钥流存储在flow1列表中；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">secret_flow</span><span class="params">(s3,p1,flow1)</span>:</span></span><br><span class="line">	<span class="string">"""生成密钥流"""</span>  </span><br><span class="line">	i=<span class="number">0</span></span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(len(p1)):</span><br><span class="line">		i=(i+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line">		j=(j+s3[i])%<span class="number">256</span></span><br><span class="line">		s3[i],s3[j]=s3[j],s3[i]</span><br><span class="line">		t=(s3[i]+s3[j])%<span class="number">256</span></span><br><span class="line">		flow1.append(s3[t])</span><br></pre></td></tr></table></figure>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>将密钥流与明文字节异或得出密文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plain_flow</span><span class="params">(p2,flow2,c)</span>:</span></span><br><span class="line">	<span class="string">"""生成密文"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(p2)):</span><br><span class="line">		temp=(flow2[i]^ord(p2[i]))</span><br><span class="line">		temp1=hex(temp)</span><br><span class="line">		c.append(temp1[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>将密钥流与密文字节异或得出明文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_rc4</span><span class="params">(c1,flow3,p_flow)</span>:</span></span><br><span class="line">	<span class="string">"""解密"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(c1)):</span><br><span class="line">		temp2=int(<span class="string">"0x"</span>+c1[i],<span class="number">16</span>)</span><br><span class="line">		p_flow.append(chr(flow3[i]^temp2))</span><br></pre></td></tr></table></figure>
<h4 id="完整代码-1"><a href="#完整代码-1" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_S_T</span><span class="params">(s1,t1,k1)</span>:</span>    </span><br><span class="line">	<span class="string">"""初始化S,T"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">		s1.append(i)</span><br><span class="line">		t1.append(k1[i%len(k1)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_s</span><span class="params">(s2,t2)</span>:</span></span><br><span class="line">	<span class="string">"""更新S"""</span></span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">		j=(j+s2[i]+t2[i])%<span class="number">256</span></span><br><span class="line">		s2[i],s2[j]=s2[j],s2[i]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">secret_flow</span><span class="params">(s3,p1,flow1)</span>:</span></span><br><span class="line">	<span class="string">"""生成密钥流"""</span>  </span><br><span class="line">	i=<span class="number">0</span></span><br><span class="line">	j=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(len(p1)):</span><br><span class="line">		i=(i+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line">		j=(j+s3[i])%<span class="number">256</span></span><br><span class="line">		s3[i],s3[j]=s3[j],s3[i]</span><br><span class="line">		t=(s3[i]+s3[j])%<span class="number">256</span></span><br><span class="line">		flow1.append(s3[t]) </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plain_flow</span><span class="params">(p2,flow2,c)</span>:</span></span><br><span class="line">	<span class="string">"""生成密文"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(p2)):</span><br><span class="line">		temp=(flow2[i]^ord(p2[i]))</span><br><span class="line">		temp1=hex(temp)</span><br><span class="line">		c.append(temp1[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_rc4</span><span class="params">(c1,flow3,p_flow)</span>:</span></span><br><span class="line">	<span class="string">"""解密"""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(c1)):</span><br><span class="line">		temp2=int(<span class="string">"0x"</span>+c1[i],<span class="number">16</span>)</span><br><span class="line">		p_flow.append(chr(flow3[i]^temp2))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">"  Encrypt Input  "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	k=raw_input(<span class="string">"Please enter the key:"</span>)</span><br><span class="line">	key=k.split(<span class="string">" "</span>)</span><br><span class="line">	key=[int(key[i]) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(key))]</span><br><span class="line">	plain=raw_input(<span class="string">"Please enter the plain:"</span>)</span><br><span class="line">	s=[] </span><br><span class="line">	t=[] </span><br><span class="line">	k_flow=[] </span><br><span class="line">	c_flow=[]</span><br><span class="line">	p_flow=[]</span><br><span class="line">	init_S_T(s,t,key) </span><br><span class="line">	update_s(s,t)</span><br><span class="line">	secret_flow(s,plain,k_flow)</span><br><span class="line">	plain_flow(plain,k_flow,c_flow)</span><br><span class="line">	<span class="keyword">print</span> <span class="number">8</span>*<span class="string">"*"</span>+<span class="string">"  Encryption  "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	<span class="comment"># print("置乱后的s盒：")</span></span><br><span class="line">	<span class="comment"># print(s)</span></span><br><span class="line">	print(<span class="string">"密钥流："</span>)</span><br><span class="line">	print(k_flow)</span><br><span class="line">	print(<span class="string">"Cipher:"</span>)</span><br><span class="line">	<span class="comment"># print c_flow</span></span><br><span class="line">	<span class="keyword">print</span><span class="string">""</span>.join(c_flow)   <span class="comment">#加密后输出密文</span></span><br><span class="line">	decode_rc4(c_flow,k_flow,p_flow)          <span class="comment">#解密后输出明文</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">"\n"</span>+<span class="number">8</span>*<span class="string">"*"</span>+<span class="string">"  Decryption  "</span>+<span class="number">8</span>*<span class="string">"*"</span></span><br><span class="line">	print(<span class="string">"Plain:"</span>)</span><br><span class="line">	<span class="keyword">print</span><span class="string">""</span>.join(p_flow)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<h3 id="运行结果及正确性-1"><a href="#运行结果及正确性-1" class="headerlink" title="运行结果及正确性"></a>运行结果及正确性</h3><p>输入8个字符的明文化成ASCII码，再转化为比特流，与得到的密钥比特流进行逐位异或，结果化成16进制得到如下密文；将密文化为比特流再与原来的密钥流进行异或，得到明文比特流，继续转化为字符得到原来的字符hellocumt；所以算法正确性得到了验证；</p>
<p><img src="https://s2.ax1x.com/2019/01/02/FINa2F.png" alt="FINa2F.png"></p>
<h3 id="安全性分析-1"><a href="#安全性分析-1" class="headerlink" title="安全性分析"></a>安全性分析</h3><p>设计流密码的一个重要步骤就是设计密钥流生成器，主要安全要求就是：</p>
<p>1.密钥流的周期要足够大；</p>
<p>2.还要使得密钥流具有随机统计特性；</p>
<p>3.密钥流的部分暴露时，序列不可被推算出来，就是序列的线性不可预测性大；</p>
<p>一般来说，密钥序列的随机特性越好，加密的安全性也就越高；RC4的密钥生成随机特性良好，周期足够大；至今对RC4的攻击都停留在理论上，在实践上并不能对RC4构成威胁；</p>
<h3 id="有效性和合理性分析-1"><a href="#有效性和合理性分析-1" class="headerlink" title="有效性和合理性分析"></a>有效性和合理性分析</h3><p>由于RC4具有良好的随机特性和抵抗各种分析的能力，密钥流随机特性较好，因此在众多领域里RC4都得到了广泛的运用；例如：无线局域网标准的WEP协议就是利用RC4对数据进行加密，保障了无线通信信号的完整性和保密性，防止了不法分子对网络的非授权访问；这样的现实应用直接证实了RC4算法的有效性和合理性；</p>
<h3 id="算法编写过程中遇到的问题及解决-1"><a href="#算法编写过程中遇到的问题及解决-1" class="headerlink" title="算法编写过程中遇到的问题及解决"></a>算法编写过程中遇到的问题及解决</h3><p>编写过程中一开始解密不对，经过学习发现是一个简单的错误，那就是序列密码是对称加密算法，加密解密需要用到相同的密钥，所以每次如果明文和种子密钥不一样的话，解密都需要更新自己的密钥流；</p>
<h1 id="非对称加密RSA"><a href="#非对称加密RSA" class="headerlink" title="非对称加密RSA"></a>非对称加密RSA</h1><h2 id="简述-2"><a href="#简述-2" class="headerlink" title="简述"></a>简述</h2><p>RSA 加密算法是一种非对称加密算法。在公开密钥加密和电子商业中 RSA 被广泛使用；</p>
<h2 id="公钥与私钥的产生"><a href="#公钥与私钥的产生" class="headerlink" title="公钥与私钥的产生"></a>公钥与私钥的产生</h2><p>1.随机选择两个不同大质数 p和 q，计算 <code>N=p×q</code></p>
<p>2.根据欧拉函数，求得<code>r=φ(N)=φ(p)φ(q)=(p−1)(q−1)</code></p>
<p>3.选择一个小于 r 的整数 e，使 e 和 r互质。并求得 e 关于 r 的模反元素，为 d，有 <code>ed≡1 mod red≡1 mod r</code></p>
<p>4.将 p 和 q 的记录销毁；</p>
<p>此时，<code>(N,e)</code>是公钥，<code>(N,d)</code>是私钥；</p>
<h2 id="消息加密"><a href="#消息加密" class="headerlink" title="消息加密"></a>消息加密</h2><p>首先需要将消息 m 以一个双方约定好的格式转化为一个小于  N，且与 N 互质的整数 n。如果消息太长，可以将消息分为几段，这也就是我们所说的分组加密，后对于每一部分利用如下公式加密：<code>n^e≡c(modN)</code>；</p>
<h2 id="消息解密"><a href="#消息解密" class="headerlink" title="消息解密"></a>消息解密</h2><p>利用密钥 d 进行解密：<code>c^d≡n(modN)</code>；</p>
<h2 id="代码分析-2"><a href="#代码分析-2" class="headerlink" title="代码分析"></a>代码分析</h2><h3 id="生成n字节的随机数"><a href="#生成n字节的随机数" class="headerlink" title="生成n字节的随机数"></a>生成n字节的随机数</h3><p>调用<code>os.urandom()</code>随机生成n字节的随机数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getrandom</span><span class="params">(n)</span>:</span></span><br><span class="line">	data=urandom(n)</span><br><span class="line">	a=int(binascii.hexlify(data),<span class="number">16</span>)</span><br><span class="line">	<span class="keyword">return</span> a</span><br></pre></td></tr></table></figure>
<h3 id="第一次素性检验"><a href="#第一次素性检验" class="headerlink" title="第一次素性检验"></a>第一次素性检验</h3><p>首先进行第一次素性检验，检验100以内的素数是否为n的因数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span><span class="params">(n)</span>:</span></span><br><span class="line">	dic_small=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">61</span>,<span class="number">67</span>,<span class="number">71</span>,<span class="number">73</span>,<span class="number">79</span>,<span class="number">83</span>,<span class="number">89</span>,<span class="number">97</span>]</span><br><span class="line">	<span class="comment"># print(len(dic_small))</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> dic_small:</span><br><span class="line">		<span class="keyword">if</span> n%x==<span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h3 id="第二次素性检验"><a href="#第二次素性检验" class="headerlink" title="第二次素性检验"></a>第二次素性检验</h3><p>用Miller-rabin素性检验算法检验n，检验k次</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_Miller</span><span class="params">(n,k)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> n&lt;<span class="number">2</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">	d=n<span class="number">-1</span></span><br><span class="line">	r=<span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">not</span>(d&amp;<span class="number">1</span>):</span><br><span class="line">		r+=<span class="number">1</span></span><br><span class="line">		d&gt;&gt;=<span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(k):</span><br><span class="line">		a=getrandom(<span class="number">120</span>)</span><br><span class="line">		x=pow(a,d,n)</span><br><span class="line">		<span class="keyword">if</span> x==<span class="number">1</span> <span class="keyword">or</span> x==n<span class="number">-1</span>:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> range(r<span class="number">-1</span>):</span><br><span class="line">			x=pow(x,<span class="number">2</span>,n)</span><br><span class="line">		<span class="keyword">if</span> x==<span class="number">1</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">		<span class="keyword">if</span> x==n<span class="number">-1</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h3 id="通过两次素性检测"><a href="#通过两次素性检测" class="headerlink" title="通过两次素性检测"></a>通过两次素性检测</h3><p>产生byte字节的数，并且通过两次素性检测</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getprime</span><span class="params">(byte)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">		n=getrandom(byte)</span><br><span class="line">		<span class="keyword">if</span> test1(n):</span><br><span class="line">			<span class="keyword">if</span> test_Miller(n,<span class="number">10</span>):</span><br><span class="line">				<span class="keyword">pass</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">return</span> n</span><br></pre></td></tr></table></figure>
<h3 id="产生公钥e"><a href="#产生公钥e" class="headerlink" title="产生公钥e"></a>产生公钥e</h3><p>产生一个和φ(n)互素的公钥e</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gete</span><span class="params">(ol)</span>:</span></span><br><span class="line">	e=getprime(<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">if</span> ol%e!=<span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> e</span><br></pre></td></tr></table></figure>
<h3 id="16进制编码"><a href="#16进制编码" class="headerlink" title="16进制编码"></a>16进制编码</h3><p>加密时，先将明文进行16进制编码，然后转化为10进制计算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexencode</span><span class="params">(str0)</span>:</span></span><br><span class="line">	hexcode=base64.b16encode(str0)</span><br><span class="line">	res=int(hexcode,<span class="number">16</span>)</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="16进制解码"><a href="#16进制解码" class="headerlink" title="16进制解码"></a>16进制解码</h3><p>解密时需要对计算出来的明文编码进行16进制解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexdecode</span><span class="params">(str0)</span>:</span></span><br><span class="line">	temp=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(str0)):</span><br><span class="line">		<span class="keyword">if</span> ord(str0[i])&gt;<span class="number">96</span> <span class="keyword">and</span> ord(str0[i])&lt;<span class="number">123</span>:</span><br><span class="line">			temp+=chr(ord(str0[i])<span class="number">-32</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			temp+=str0[i]</span><br><span class="line">	res=base64.b16decode(temp)</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="分组加密一组"><a href="#分组加密一组" class="headerlink" title="分组加密一组"></a>分组加密一组</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAencrypt_group</span><span class="params">(m,e,n)</span>:</span></span><br><span class="line">	num1=hexencode(m)                            </span><br><span class="line"> 	c=pow(num1,e,n)                    <span class="comment">#cipher</span></span><br><span class="line">	<span class="keyword">return</span> c</span><br></pre></td></tr></table></figure>
<h3 id="加密全部-1"><a href="#加密全部-1" class="headerlink" title="加密全部"></a>加密全部</h3><p>5个字符一组进行加密,将所有的密文连接在一起输出，将每个分组的密文存储在cip列表中用于以后的解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAencrypt_all</span><span class="params">(m,e,n)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(m),<span class="number">5</span>):</span><br><span class="line">		temp=m[i:i+<span class="number">5</span>]</span><br><span class="line">		group_cipher=RSAencrypt_group(temp,e,n)</span><br><span class="line">		cip.append(group_cipher)</span><br><span class="line">		res+=str(group_cipher)</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="解密一组-1"><a href="#解密一组-1" class="headerlink" title="解密一组"></a>解密一组</h3><p>输入数字c进行RSA解密得到num1，然后再转化为16进制，再对16进制数进行解码变成明文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAdecrypt_group</span><span class="params">(c,e,n,ol)</span>:</span></span><br><span class="line">	d=gmpy2.invert(e,ol)</span><br><span class="line">	num1=pow(c,d,n)</span><br><span class="line">	str1=<span class="string">'&#123;:0x&#125;'</span>.format(num1)</span><br><span class="line">	plain=hexdecode(str1)</span><br><span class="line">	<span class="keyword">return</span> plain</span><br></pre></td></tr></table></figure>
<h3 id="解密全部-1"><a href="#解密全部-1" class="headerlink" title="解密全部"></a>解密全部</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAdecrypt_all</span><span class="params">(e,n,ol)</span>:</span></span><br><span class="line">	res=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(cip)):</span><br><span class="line">		temp=RSAdecrypt_group(cip[i],e,n,ol)</span><br><span class="line">		res+=temp</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h2 id="运行结果及正确性验证"><a href="#运行结果及正确性验证" class="headerlink" title="运行结果及正确性验证"></a>运行结果及正确性验证</h2><p><strong>理论证明：</strong></p>
<p>即我们要证<code>n^ed≡n(modN)</code>，已知<code>ed≡1modϕ(N)</code>，那么 <code>ed=kϕ(N)+1</code>，即需要证明</p>
<p><code>n^(kϕ(N)+1)≡n(modN)</code></p>
<p>这里我们分两种情况证明</p>
<p>第一种情况 gcd(n,N)=1，那么 <code>n^ϕ(N)≡1modN</code>，因此原式成立。</p>
<p>第二种情况 gcd(n,N)!=1，那么 n 必然是 p 或者 q 的倍数，并且 n 小于 N。我们假设<code>n=xp</code></p>
<p>那么 x 必然小于 q，又由于 q 是素数。那么<code>n^ϕ(q)≡1modq</code></p>
<p>进而<code>n^kϕ(N)=n^(k(p−1)(q−1))=(n^ϕ(q))^k(p−1)≡1modq</code></p>
<p>那么<code>n^(kϕ(N)+1)=n+uqn</code>进而<code>nkϕ(N)+1=n+uqxp=n+uxN</code>；所以原式成立。</p>
<p><strong>程序正确性：</strong></p>
<p>程序输入明文hello，加载出1024bit的大素数p和q，继续加载出公钥e，经过加密得到如下密文；就用上面得到的p,q,e,cipher，先计算出私钥d，再解密密文，得到如下明文hello，解密成功，算法正确性得到验证；</p>
<p><img src="https://s2.ax1x.com/2019/01/03/Fo8GnI.png" alt="Fo8GnI.png"></p>
<h2 id="安全性分析-2"><a href="#安全性分析-2" class="headerlink" title="安全性分析"></a>安全性分析</h2><p>RSA 算法的可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。如今，只有短的 RSA 密钥才可能被强力方式解破，RSA算法选取的两个安全的大素数目前推荐长度为至少为1024比特；到现在为止，还没有任何可靠的攻击 RSA 算法的方式。</p>
<h3 id="RSA的共模攻击分析"><a href="#RSA的共模攻击分析" class="headerlink" title="RSA的共模攻击分析"></a>RSA的共模攻击分析</h3><h5 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h5><p>当两个用户使用相同的模数 N、不同的私钥时，加密同一明文消息时即存在共模攻击；</p>
<p>设两个用户的公钥分别为 e1和 e2，且两者互质。明文消息为 mm，密文分别为：<code>c1=m^e1(modN)</code> <code>c2=m^e2(modN)</code></p>
<p>当攻击者截获 c1和 c2后，就可以恢复出明文。用扩展欧几里得算法求出 <code>re1+se2=1modn</code>的两个整数 r 和 s，由此可得：</p>
<p><code>(c^r1)*(c^s2)≡(m^re1)*(m^se2)modn≡m^(re1+se2)modn≡m(modn)</code></p>
<h5 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h5><p>就拿CTF比赛Crypto中的一道题目来说：给出两组密文 message1,message2；给出两组分别的公钥是e1和e2；给出两组加密用的是同一个n；如何去计算出明文呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,773&#125;</span><br><span class="line">&#123;6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,839&#125;</span><br><span class="line">message1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span><br><span class="line">message2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span><br></pre></td></tr></table></figure>
<p>可以看出两个公钥的 N 是一样的，并且两者的 e 互素。用上述原理写一个python脚本跑一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=<span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span></span><br><span class="line">e1 = <span class="number">773</span></span><br><span class="line">e2 = <span class="number">839</span></span><br><span class="line">message1=<span class="number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span></span><br><span class="line">message2=<span class="number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span></span><br><span class="line"><span class="comment"># s &amp; t</span></span><br><span class="line">gcd, s, t = gmpy2.gcdext(e1, e2)</span><br><span class="line"><span class="keyword">if</span> s &lt; <span class="number">0</span>:</span><br><span class="line">    s = -s</span><br><span class="line">    message1 = gmpy2.invert(message1, n)</span><br><span class="line"><span class="keyword">if</span> t &lt; <span class="number">0</span>:</span><br><span class="line">    t = -t</span><br><span class="line">    message2 = gmpy2.invert(message2, n)</span><br><span class="line">plain = gmpy2.powmod(message1, s, n) * gmpy2.powmod(message2, t, n) % n</span><br><span class="line"><span class="keyword">print</span> plain</span><br></pre></td></tr></table></figure>
<p>得出结果明文：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1021089710312311910410111011910111610410511010710511610511511211111511510598108101125</span><br></pre></td></tr></table></figure>
<p>这时候需要考虑当时明文是如何转化为这个数字了，这个应该是 ASCII 字符转换，进而我们使用如下代码得到 flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">plain = str(plain)</span><br><span class="line"><span class="keyword">while</span> i &lt; len(plain):</span><br><span class="line">    <span class="keyword">if</span> plain[i] == <span class="string">'1'</span>:</span><br><span class="line">        flag += chr(int(plain[i:i + <span class="number">3</span>]))</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += chr(int(plain[i:i + <span class="number">2</span>]))</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment">###flag&#123;whenwethinkitispossible&#125;###</span></span><br></pre></td></tr></table></figure>
<h2 id="有效性和合理性分析-2"><a href="#有效性和合理性分析-2" class="headerlink" title="有效性和合理性分析"></a>有效性和合理性分析</h2><p>公钥加密中密钥1024bit的密钥强度只能相当于对称加密中几十bit的强度，而且密钥的生成需要时间，所以还是对称加密的效率较高，而且耗时较短，速度比较快；一般通信中采用的就是明文采用对称加密的方法发出，而加解密密钥用公钥加密体制加密后发给接收方，这样效率会比较高；</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Gard3nia</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://gardenia30.top/2019/01/13/密码学笔记/">https://gardenia30.top/2019/01/13/密码学笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/01/14/CUMT-CTF双月赛Writeup/"><i class="fa fa-chevron-left">  </i><span>CUMTCTF双月赛Writeup</span></a></div><div class="next-post pull-right"><a href="/2018/12/22/DigitalOcean+PuTTY+SS如何撸梯子/"><span>DigitalOcean+PuTTY+SS如何撸梯子</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By Gard3nia</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Just keep moving!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>